/**
 * dat.GUI JavaScript Controller Library
 * http://code.google.com/p/dat-gui
 *
 * Copyright 2011-2019 Data Arts Team, Google Creative Lab
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */

!(function(e, t) {
  "object" == typeof exports && "undefined" != typeof module
    ? t(exports)
    : "function" == typeof define && define.amd
    ? define(["exports"], t)
    : t(((e = e || self).dat = {}));
})(this, function(t) {
  "use strict";
  function n(e, t) {
    var n = e.__state.conversionName.toString(),
      i = Math.round(e.r),
      o = Math.round(e.g),
      a = Math.round(e.b),
      r = e.a,
      s = Math.round(e.h),
      l = e.s.toFixed(1),
      d = e.v.toFixed(1);
    if (t || "THREE_CHAR_HEX" === n || "SIX_CHAR_HEX" === n) {
      for (var u = e.hex.toString(16); u.length < 6; ) u = "0" + u;
      return "#" + u;
    }
    return "CSS_RGB" === n
      ? "rgb(" + i + "," + o + "," + a + ")"
      : "CSS_RGBA" === n
      ? "rgba(" + i + "," + o + "," + a + "," + r + ")"
      : "HEX" === n
      ? "0x" + e.hex.toString(16)
      : "RGB_ARRAY" === n
      ? "[" + i + "," + o + "," + a + "]"
      : "RGBA_ARRAY" === n
      ? "[" + i + "," + o + "," + a + "," + r + "]"
      : "RGB_OBJ" === n
      ? "{r:" + i + ",g:" + o + ",b:" + a + "}"
      : "RGBA_OBJ" === n
      ? "{r:" + i + ",g:" + o + ",b:" + a + ",a:" + r + "}"
      : "HSV_OBJ" === n
      ? "{h:" + s + ",s:" + l + ",v:" + d + "}"
      : "HSVA_OBJ" === n
      ? "{h:" + s + ",s:" + l + ",v:" + d + ",a:" + r + "}"
      : "unknown format";
  }
  var i,
    o = Array.prototype.slice,
    h = {
      BREAK: {},
      extend: function(n) {
        return (
          this.each(
            o.call(arguments, 1),
            function(t) {
              (this.isObject(t) ? Object.keys(t) : []).forEach(
                function(e) {
                  this.isUndefined(t[e]) || (n[e] = t[e]);
                }.bind(this)
              );
            },
            this
          ),
          n
        );
      },
      defaults: function(n) {
        return (
          this.each(
            o.call(arguments, 1),
            function(t) {
              (this.isObject(t) ? Object.keys(t) : []).forEach(
                function(e) {
                  this.isUndefined(n[e]) && (n[e] = t[e]);
                }.bind(this)
              );
            },
            this
          ),
          n
        );
      },
      compose: function() {
        var n = o.call(arguments);
        return function() {
          for (var e = o.call(arguments), t = n.length - 1; 0 <= t; t--) e = [n[t].apply(this, e)];
          return e[0];
        };
      },
      each: function(e, t, n) {
        if (e)
          if (e.forEach) e.forEach(t, n);
          else if (e.length === e.length + 0) {
            var i, o;
            for (i = 0, o = e.length; i < o; i++) if (i in e && t.call(n, e[i], i) === this.BREAK) return;
          } else for (var a in e) if (t.call(n, e[a], a) === this.BREAK) return;
      },
      defer: function(e) {
        setTimeout(e, 0);
      },
      debounce: function(i, o, a) {
        var r;
        return function() {
          var e = this,
            t = arguments;
          var n = a || !r;
          clearTimeout(r),
            (r = setTimeout(function() {
              (r = null), a || i.apply(e, t);
            }, o)),
            n && i.apply(e, t);
        };
      },
      toArray: function(e) {
        return e.toArray ? e.toArray() : o.call(e);
      },
      isUndefined: function(e) {
        return void 0 === e;
      },
      isNull: function(e) {
        return null === e;
      },
      isNaN: ((i = function(e) {
        return isNaN(e);
      }),
      (a.toString = function() {
        return i.toString();
      }),
      a),
      isArray: function(e) {
        return null != e && 0 <= e.length && "object" == typeof e;
      },
      isObject: function(e) {
        return e === Object(e);
      },
      isNumber: function(e) {
        return e === e + 0;
      },
      isString: function(e) {
        return e === e + "";
      },
      isBoolean: function(e) {
        return !1 === e || !0 === e;
      },
      isFunction: function(e) {
        return "[object Function]" === Object.prototype.toString.call(e);
      },
      supportsPassive: function() {
        var e = !1;
        try {
          var t = Object.defineProperty({}, "passive", {
            get: function() {
              return !(e = !0);
            }
          });
          window.addEventListener("testPassive", null, t), window.removeEventListener("testPassive", null, t);
        } catch (e) {}
        return e;
      }
    };
  function a(e) {
    return i.apply(this, arguments);
  }
  function p(e) {
    s = !1;
    var n = 1 < arguments.length ? h.toArray(arguments) : e;
    return (
      h.each(u, function(e) {
        if (e.litmus(n))
          return (
            h.each(e.conversions, function(e, t) {
              if (((r = e.read(n)), !1 === s && !1 !== r))
                return ((s = r).conversionName = t), (r.conversion = e), h.BREAK;
            }),
            h.BREAK
          );
      }),
      s
    );
  }
  var r,
    s,
    l,
    d,
    u = [
      {
        litmus: h.isString,
        conversions: {
          THREE_CHAR_HEX: {
            read: function(e) {
              var t = e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);
              return (
                null !== t && {
                  space: "HEX",
                  hex: parseInt(
                    "0x" +
                      t[1].toString() +
                      t[1].toString() +
                      t[2].toString() +
                      t[2].toString() +
                      t[3].toString() +
                      t[3].toString(),
                    0
                  )
                }
              );
            },
            write: n
          },
          SIX_CHAR_HEX: {
            read: function(e) {
              var t = e.match(/^#([A-F0-9]{6})$/i);
              return null !== t && { space: "HEX", hex: parseInt("0x" + t[1].toString(), 0) };
            },
            write: n
          },
          CSS_RGB: {
            read: function(e) {
              var t = e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);
              return null !== t && { space: "RGB", r: parseFloat(t[1]), g: parseFloat(t[2]), b: parseFloat(t[3]) };
            },
            write: n
          },
          CSS_RGBA: {
            read: function(e) {
              var t = e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);
              return (
                null !== t && {
                  space: "RGB",
                  r: parseFloat(t[1]),
                  g: parseFloat(t[2]),
                  b: parseFloat(t[3]),
                  a: parseFloat(t[4])
                }
              );
            },
            write: n
          }
        }
      },
      {
        litmus: h.isNumber,
        conversions: {
          HEX: {
            read: function(e) {
              return { space: "HEX", hex: e, conversionName: "HEX" };
            },
            write: function(e) {
              return e.hex;
            }
          }
        }
      },
      {
        litmus: h.isArray,
        conversions: {
          RGB_ARRAY: {
            read: function(e) {
              return 3 === e.length && { space: "RGB", r: e[0], g: e[1], b: e[2] };
            },
            write: function(e) {
              return [e.r, e.g, e.b];
            }
          },
          RGBA_ARRAY: {
            read: function(e) {
              return 4 === e.length && { space: "RGB", r: e[0], g: e[1], b: e[2], a: e[3] };
            },
            write: function(e) {
              return [e.r, e.g, e.b, e.a];
            }
          }
        }
      },
      {
        litmus: h.isObject,
        conversions: {
          RGBA_OBJ: {
            read: function(e) {
              return (
                !!(h.isNumber(e.r) && h.isNumber(e.g) && h.isNumber(e.b) && h.isNumber(e.a)) && {
                  space: "RGB",
                  r: e.r,
                  g: e.g,
                  b: e.b,
                  a: e.a
                }
              );
            },
            write: function(e) {
              return { r: e.r, g: e.g, b: e.b, a: e.a };
            }
          },
          RGB_OBJ: {
            read: function(e) {
              return (
                !!(h.isNumber(e.r) && h.isNumber(e.g) && h.isNumber(e.b)) && { space: "RGB", r: e.r, g: e.g, b: e.b }
              );
            },
            write: function(e) {
              return { r: e.r, g: e.g, b: e.b };
            }
          },
          HSVA_OBJ: {
            read: function(e) {
              return (
                !!(h.isNumber(e.h) && h.isNumber(e.s) && h.isNumber(e.v) && h.isNumber(e.a)) && {
                  space: "HSV",
                  h: e.h,
                  s: e.s,
                  v: e.v,
                  a: e.a
                }
              );
            },
            write: function(e) {
              return { h: e.h, s: e.s, v: e.v, a: e.a };
            }
          },
          HSV_OBJ: {
            read: function(e) {
              return (
                !!(h.isNumber(e.h) && h.isNumber(e.s) && h.isNumber(e.v)) && { space: "HSV", h: e.h, s: e.s, v: e.v }
              );
            },
            write: function(e) {
              return { h: e.h, s: e.s, v: e.v };
            }
          }
        }
      }
    ],
    c = {
      hsv_to_rgb: function(e, t, n) {
        var i = Math.floor(e / 60) % 6,
          o = e / 60 - Math.floor(e / 60),
          a = n * (1 - t),
          r = n * (1 - o * t),
          s = n * (1 - (1 - o) * t),
          l = [[n, s, a], [r, n, a], [a, n, s], [a, r, n], [s, a, n], [n, a, r]][i];
        return { r: 255 * l[0], g: 255 * l[1], b: 255 * l[2] };
      },
      rgb_to_hsv: function(e, t, n) {
        var i,
          o = Math.min(e, t, n),
          a = Math.max(e, t, n),
          r = a - o;
        return 0 === a
          ? { h: NaN, s: 0, v: 0 }
          : ((i = e === a ? (t - n) / r : t === a ? 2 + (n - e) / r : 4 + (e - t) / r),
            (i /= 6) < 0 && (i += 1),
            { h: 360 * i, s: r / a, v: a / 255 });
      },
      rgb_to_hex: function(e, t, n) {
        var i = this.hex_with_component(0, 2, e);
        return (i = this.hex_with_component(i, 1, t)), (i = this.hex_with_component(i, 0, n));
      },
      component_from_hex: function(e, t) {
        return (e >> (8 * t)) & 255;
      },
      hex_with_component: function(e, t, n) {
        return (n = (n << (l = 8 * t)) | (e & ~(255 << l)));
      }
    },
    f = (((d = _.prototype).toString = function() {
      return n(this);
    }),
    (d.toHexString = function() {
      return n(this, !0);
    }),
    (d.toOriginal = function() {
      return this.__state.conversion.write(this);
    }),
    _);
  function _() {
    if (((this.__state = p.apply(this, arguments)), !1 === this.__state))
      throw new Error("Failed to interpret color arguments");
    this.__state.a = this.__state.a || 1;
  }
  function m(e, t, n) {
    Object.defineProperty(e, t, {
      get: function() {
        return "RGB" === this.__state.space || f.recalculateRGB(this, t, n), this.__state[t];
      },
      set: function(e) {
        "RGB" !== this.__state.space && (f.recalculateRGB(this, t, n), (this.__state.space = "RGB")),
          (this.__state[t] = e);
      }
    });
  }
  function g(e, t) {
    Object.defineProperty(e, t, {
      get: function() {
        return "HSV" === this.__state.space || f.recalculateHSV(this), this.__state[t];
      },
      set: function(e) {
        "HSV" !== this.__state.space && (f.recalculateHSV(this), (this.__state.space = "HSV")), (this.__state[t] = e);
      }
    });
  }
  (f.recalculateRGB = function(e, t, n) {
    if ("HEX" === e.__state.space) e.__state[t] = c.component_from_hex(e.__state.hex, n);
    else {
      if ("HSV" !== e.__state.space) throw new Error("Corrupted color state");
      h.extend(e.__state, c.hsv_to_rgb(e.__state.h, e.__state.s, e.__state.v));
    }
  }),
    (f.recalculateHSV = function(e) {
      var t = c.rgb_to_hsv(e.r, e.g, e.b);
      h.extend(e.__state, { s: t.s, v: t.v }),
        h.isNaN(t.h) ? h.isUndefined(e.__state.h) && (e.__state.h = 0) : (e.__state.h = t.h);
    }),
    (f.COMPONENTS = ["r", "g", "b", "h", "s", "v", "hex", "a"]),
    m(f.prototype, "r", 2),
    m(f.prototype, "g", 1),
    m(f.prototype, "b", 0),
    g(f.prototype, "h"),
    g(f.prototype, "s"),
    g(f.prototype, "v"),
    Object.defineProperty(f.prototype, "a", {
      get: function() {
        return this.__state.a;
      },
      set: function(e) {
        this.__state.a = e;
      }
    }),
    Object.defineProperty(f.prototype, "hex", {
      get: function() {
        return (
          "HEX" !== !this.__state.space && (this.__state.hex = c.rgb_to_hex(this.r, this.g, this.b)), this.__state.hex
        );
      },
      set: function(e) {
        (this.__state.space = "HEX"), (this.__state.hex = e);
      }
    });
  var v,
    b = (((v = y.prototype).hide = function() {
      return (this.domElement.parentNode.parentNode.style.display = "none"), this;
    }),
    (v.show = function() {
      return (this.domElement.parentNode.parentNode.style.display = ""), this;
    }),
    (v.onChange = function(e) {
      return (this.__onChange = e), this;
    }),
    (v.onFinishChange = function(e) {
      return (this.__onFinishChange = e), this;
    }),
    (v.setValue = function(e, t) {
      void 0 === t && (t = !1);
      var n = this.__transformOutput(e),
        i = this.object[this.property];
      return (
        (this.object[this.property] = n),
        this.__onChange && !t && this.__onChange.call(this, n, i),
        this.updateDisplay(),
        this
      );
    }),
    (v.getValue = function() {
      return this.__transformInput(this.object[this.property]);
    }),
    (v.updateDisplay = function() {
      return this;
    }),
    (v.isModified = function() {
      return this.initialValue !== this.getValue();
    }),
    (v.transform = function(e, t) {
      return (
        void 0 === e &&
          (e = function(e) {
            return e;
          }),
        void 0 === t &&
          (t = function(e) {
            return e;
          }),
        (this.__transformInput = e),
        (this.__transformOutput = t),
        this.updateDisplay(),
        this
      );
    }),
    (v.readonly = function(e) {
      return (this._readonly = e), this;
    }),
    (v.borderColor = function(e) {
      return (this.__li.style.borderLeftColor = e), this;
    }),
    (v.borderWidth = function(e) {
      return (this.__li.style.borderLeftWidth = e + "px"), this;
    }),
    y);
  function y(e, t) {
    (this.initialValue = e[t]),
      (this.domElement = document.createElement("div")),
      (this.object = e),
      (this.property = t),
      (this._readonly = !1),
      (this.__onChange = void 0),
      (this.__onFinishChange = void 0),
      (this.__transformInput = function(e) {
        return e;
      }),
      (this.__transformOutput = function(e) {
        return e;
      }),
      (this.forceUpdateDisplay = !1);
  }
  function w(e, t) {
    (e.prototype = Object.create(t.prototype)), ((e.prototype.constructor = e).__proto__ = t);
  }
  function C(e) {
    if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
    return e;
  }
  var E = {};
  h.each(
    {
      HTMLEvents: ["change"],
      MouseEvents: ["click", "mousemove", "mousedown", "mouseup", "mouseover", "wheel"],
      KeyboardEvents: ["keydown"]
    },
    function(e, t) {
      h.each(e, function(e) {
        E[e] = t;
      });
    }
  );
  var x = /(\d+(\.\d+)?)px/;
  function S(e) {
    if ("0" === e || h.isUndefined(e)) return 0;
    var t = e.match(x);
    return h.isNull(t) ? 0 : parseFloat(t[1]);
  }
  var k,
    A = {
      makeSelectable: function(e, t) {
        void 0 !== e &&
          void 0 !== e.style &&
          ((e.onselectstart = t
            ? function() {
                return !1;
              }
            : function() {}),
          (e.style.MozUserSelect = t ? "auto" : "none"),
          (e.style.KhtmlUserSelect = t ? "auto" : "none"),
          (e.unselectable = t ? "on" : "off"));
      },
      makeFullscreen: function(e, t, n) {
        var i = n,
          o = t;
        h.isUndefined(o) && (o = !0),
          h.isUndefined(i) && (i = !0),
          (e.style.position = "absolute"),
          o && ((e.style.left = 0), (e.style.right = 0)),
          i && ((e.style.top = 0), (e.style.bottom = 0));
      },
      fakeEvent: function(e, t, n, i) {
        var o = n || {},
          a = E[t];
        if (!a) throw new Error("Event type " + t + " not supported.");
        var r = document.createEvent(a);
        switch (a) {
          case "MouseEvents":
            var s = o.x || o.clientX || 0,
              l = o.y || o.clientY || 0;
            r.initMouseEvent(
              t,
              o.bubbles || !1,
              o.cancelable || !0,
              window,
              o.clickCount || 1,
              0,
              0,
              s,
              l,
              !1,
              !1,
              !1,
              !1,
              0,
              null
            );
            break;
          case "KeyboardEvents":
            var d = r.initKeyboardEvent || r.initKeyEvent;
            h.defaults(o, {
              cancelable: !0,
              ctrlKey: !1,
              altKey: !1,
              shiftKey: !1,
              metaKey: !1,
              keyCode: void 0,
              charCode: void 0
            }),
              d(
                t,
                o.bubbles || !1,
                o.cancelable,
                window,
                o.ctrlKey,
                o.altKey,
                o.shiftKey,
                o.metaKey,
                o.keyCode,
                o.charCode
              );
            break;
          default:
            r.initEvent(t, o.bubbles || !1, o.cancelable || !0);
        }
        h.defaults(r, i), e.dispatchEvent(r);
      },
      bind: function(e, t, n, i, o) {
        var a = i || !1,
          r = o || !1;
        if (e.addEventListener) {
          var s = h.supportsPassive() ? { capture: a, passive: r } : a;
          e.addEventListener(t, n, s);
        } else e.attachEvent && e.attachEvent("on" + t, n);
        return A;
      },
      unbind: function(e, t, n, i) {
        var o = i || !1;
        return e.removeEventListener ? e.removeEventListener(t, n, o) : e.detachEvent && e.detachEvent("on" + t, n), A;
      },
      addClass: function(e, t) {
        if (void 0 === e.className) e.className = t;
        else if (e.className !== t) {
          var n = e.className.split(/ +/);
          -1 === n.indexOf(t) &&
            (n.push(t),
            (e.className = n
              .join(" ")
              .replace(/^\s+/, "")
              .replace(/\s+$/, "")));
        }
        return A;
      },
      removeClass: function(e, t) {
        if (t)
          if (e.className === t) e.removeAttribute("class");
          else {
            var n = e.className.split(/ +/),
              i = n.indexOf(t);
            -1 !== i && (n.splice(i, 1), (e.className = n.join(" ")));
          }
        else e.className = void 0;
        return A;
      },
      hasClass: function(e, t) {
        return new RegExp("(?:^|\\s+)" + t + "(?:\\s+|$)").test(e.className) || !1;
      },
      getWidth: function(e) {
        var t = getComputedStyle(e);
        return (
          S(t["border-left-width"]) +
          S(t["border-right-width"]) +
          S(t["padding-left"]) +
          S(t["padding-right"]) +
          S(t.width)
        );
      },
      getHeight: function(e) {
        var t = getComputedStyle(e);
        return (
          S(t["border-top-width"]) +
          S(t["border-bottom-width"]) +
          S(t["padding-top"]) +
          S(t["padding-bottom"]) +
          S(t.height)
        );
      },
      getOffset: function(e) {
        var t = e,
          n = { left: 0, top: 0 };
        if (t.offsetParent) for (; (n.left += t.offsetLeft), (n.top += t.offsetTop), (t = t.offsetParent); );
        return n;
      },
      isActive: function(e) {
        return e === document.activeElement && (e.type || e.href);
      }
    },
    T = (function(o) {
      function e(e, t) {
        var n,
          i = C((n = o.call(this, e, t) || this));
        return (
          (n.__prev = n.getValue()),
          (n.__checkbox = document.createElement("input")),
          n.__checkbox.setAttribute("type", "checkbox"),
          A.bind(
            n.__checkbox,
            "change",
            function() {
              i._readonly || i.setValue(!i.__prev);
            },
            !1,
            !0
          ),
          n.domElement.appendChild(n.__checkbox),
          n.updateDisplay(),
          n
        );
      }
      w(e, o);
      var t = e.prototype;
      return (
        (t.setValue = function(e, t) {
          void 0 === t && (t = !1);
          var n = o.prototype.setValue.call(this, e, t);
          return (
            this.__onFinishChange && !t && this.__onFinishChange.call(this, this.getValue()),
            (this.__prev = this.getValue()),
            n
          );
        }),
        (t.updateDisplay = function() {
          return (
            !0 === this.getValue()
              ? (this.__checkbox.setAttribute("checked", "checked"), (this.__checkbox.checked = !0), (this.__prev = !0))
              : ((this.__checkbox.checked = !1), (this.__prev = !1)),
            o.prototype.updateDisplay.call(this)
          );
        }),
        e
      );
    })(b),
    L = (function(s) {
      function e(e, t, n) {
        var i,
          o = n,
          a = C((i = s.call(this, e, t) || this));
        if (((i.__select = document.createElement("select")), h.isArray(o))) {
          var r = {};
          h.each(o, function(e) {
            r[e] = e;
          }),
            (o = r);
        }
        return (
          h.each(o, function(e, t) {
            var n = document.createElement("option");
            (n.innerHTML = t), n.setAttribute("value", e), a.__select.appendChild(n);
          }),
          i.updateDisplay(),
          A.bind(
            i.__select,
            "change",
            function() {
              var e = this.options[this.selectedIndex].value;
              a.setValue(e);
            },
            !1,
            !0
          ),
          i.domElement.appendChild(i.__select),
          i
        );
      }
      w(e, s);
      var t = e.prototype;
      return (
        (t.setValue = function(e, t) {
          if ((void 0 === t && (t = !1), this._readonly)) return this.getValue();
          var n = s.prototype.setValue.call(this, e, t);
          return this.__onFinishChange && !t && this.__onFinishChange.call(this, this.getValue()), n;
        }),
        (t.updateDisplay = function() {
          return A.isActive(this.__select) && !this.forceUpdateDisplay
            ? this
            : ((this.__select.value = this.getValue()), s.prototype.updateDisplay.call(this));
        }),
        e
      );
    })(b),
    O = (w(B, (k = b)),
    (B.prototype.updateDisplay = function() {
      return A.isActive(this.__input) || (this.__input.value = this.getValue()), k.prototype.updateDisplay.call(this);
    }),
    B);
  function B(e, t) {
    var n,
      i = C((n = k.call(this, e, t) || this));
    function o() {
      i._readonly || i.setValue(i.__input.value);
    }
    return (
      (n.__input = document.createElement("input")),
      n.__input.setAttribute("type", "text"),
      A.bind(n.__input, "keyup", o, !1, !0),
      A.bind(n.__input, "change", o, !1, !0),
      A.bind(
        n.__input,
        "blur",
        function() {
          i.__onFinishChange && i.__onFinishChange.call(i, i.getValue());
        },
        !1,
        !0
      ),
      A.bind(
        n.__input,
        "keydown",
        function(e) {
          13 === e.keyCode && this.blur();
        },
        !1,
        !0
      ),
      n.updateDisplay(),
      n.domElement.appendChild(n.__input),
      n
    );
  }
  function V(e) {
    var t = e.toString();
    return -1 < t.indexOf(".") ? t.length - t.indexOf(".") - 1 : 2;
  }
  var N = (function(a) {
    function e(e, t, n) {
      var i,
        o = n || {};
      return (
        ((i = a.call(this, e, t) || this).__min = o.min),
        (i.__max = o.max),
        (i.__step = o.step),
        h.isUndefined(i.__step)
          ? 0 === i.initialValue
            ? (i.__impliedStep = 1)
            : (i.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(i.initialValue)) / Math.LN10)) / 10)
          : (i.__impliedStep = i.__step),
        (i.__precision = V(i.__impliedStep)),
        i
      );
    }
    w(e, a);
    var t = e.prototype;
    return (
      (t.setValue = function(e, t) {
        void 0 === t && (t = !1);
        var n = e;
        return (
          void 0 !== this.__min && n < this.__min
            ? (n = this.__min)
            : void 0 !== this.__max && n > this.__max && (n = this.__max),
          void 0 !== this.__step && n % this.__step != 0 && (n = Math.round(n / this.__step) * this.__step),
          a.prototype.setValue.call(this, n, t)
        );
      }),
      (t.min = function(e) {
        return (this.__min = e), this;
      }),
      (t.max = function(e) {
        return (this.__max = e), this;
      }),
      (t.step = function(e) {
        return (
          (this.__step = e),
          (this.__impliedStep = e),
          (this.__precision = V(e)),
          this.__input && this.__input.setAttribute("step", e),
          this
        );
      }),
      e
    );
  })(b);
  var R,
    I = (w(D, (R = N)),
    (D.prototype.updateDisplay = function() {
      if (this.__input !== document.activeElement)
        return (
          (this.__input.value = this.__truncationSuspended
            ? this.getValue()
            : (function(e, t) {
                var n = Math.pow(10, t);
                return Math.round(e * n) / n;
              })(this.getValue(), this.__precision) + this.__suffix),
          R.prototype.updateDisplay.call(this)
        );
    }),
    D);
  function D(e, t, n) {
    var i;
    i = R.call(this, e, t, n) || this;
    var o = n || {};
    (i.__suffix = o.suffix ? o.suffix : ""), (i.__truncationSuspended = !1);
    var a,
      r = C(i);
    function s() {
      r.__onFinishChange && r.__onFinishChange.call(r, r.getValue());
    }
    function l(e) {
      var t = a - e.clientY;
      r.setValue(r.getValue() + t * r.__impliedStep), (a = e.clientY);
    }
    function d() {
      A.unbind(window, "mousemove", l), A.unbind(window, "mouseup", d), s();
    }
    return (
      (i.__input = document.createElement("input")),
      i.__input.setAttribute("type", "text"),
      (i.__up = document.createElement("button")),
      i.__up.setAttribute(
        "style",
        "position:absolute;right:0;height:10px;top:4px;background-color: #555;border: none;"
      ),
      (i.__down = document.createElement("button")),
      i.__down.setAttribute(
        "style",
        "position:absolute;right:0;height:10px;top:15px;background-color: #555;border: none;"
      ),
      A.bind(i.__up, "mousedown", function() {
        r.setValue(r.getValue() + r.__impliedStep);
      }),
      A.bind(i.__down, "mousedown", function() {
        r.setValue(r.getValue() - r.__impliedStep);
      }),
      A.bind(
        i.__input,
        "change",
        function() {
          var e = r.__input.value;
          n && r.__suffix && (e = e.replace(r.__suffix, ""));
          var t = parseFloat(e);
          h.isNaN(t) || r._readonly || r.setValue(t);
        },
        !1,
        !0
      ),
      A.bind(
        i.__input,
        "blur",
        function() {
          s();
        },
        !1,
        !0
      ),
      A.bind(
        i.__input,
        "mousedown",
        function(e) {
          A.bind(window, "mousemove", l, !1, !0), A.bind(window, "mouseup", d, !1, !0), (a = e.clientY);
        },
        !1,
        !0
      ),
      A.bind(i.__input, "wheel", function(e) {
        e.preventDefault();
        var t = -e.deltaY >> 10 || 1;
        r.setValue(r.getValue() + t * r.__impliedStep);
      }),
      A.bind(
        i.__input,
        "keydown",
        function(e) {
          switch (e.keyCode) {
            case 13:
              (r.__truncationSuspended = !0), this.blur(), (r.__truncationSuspended = !1), s();
              break;
            case 38:
              r.setValue(r.getValue() + r.__impliedStep);
              break;
            case 40:
              r.setValue(r.getValue() - r.__impliedStep);
          }
        },
        !1,
        !0
      ),
      i.updateDisplay(),
      i.domElement.appendChild(i.__input),
      i.domElement.appendChild(i.__up),
      i.domElement.appendChild(i.__down),
      i
    );
  }
  var H,
    F = (w(M, (H = N)),
    (M.prototype.updateDisplay = function() {
      if (this.__input !== document.activeElement) {
        var e = (this.getValue() - this.__min) / (this.__max - this.__min);
        return (this.__foreground.style.width = 100 * e + "%"), H.prototype.updateDisplay.call(this);
      }
    }),
    M);
  function M(t, n, i, o, a) {
    var r,
      s = C((r = H.call(this, t, n, { min: i, max: o, step: a }) || this));
    function l(e) {
      d(e.clientX);
    }
    function d() {
      var t = s.__background.getBoundingClientRect();
      return (
        s._readonly ||
          s.setValue(
            (function(e, t, n, i, o) {
              return i + ((e - t) / (n - t)) * (o - i);
            })(e.clientX, t.left, t.right, s.__min, s.__max)
          ),
        !1
      );
    }
    function u() {
      A.unbind(window, "mousemove", l),
        A.unbind(window, "mouseup", u),
        s.__onFinishChange && s.__onFinishChange.call(s, s.getValue());
    }
    function c(e) {
      for (var t = e.changedTouches, n = 0; n < t.length; n++)
        t[n].identifier === s.__activeTouch.identifier && d(t[n].clientX);
    }
    function _() {
      A.unbind(window, "touchmove", c),
        A.unbind(window, "touchend", _),
        (s.__activeTouch = null),
        s.__onFinishChange && s.__onFinishChange.call(s, s.getValue());
    }
    return (
      (r.__background = document.createElement("div")),
      (r.__foreground = document.createElement("div")),
      A.bind(r.__background, "mousedown", function(e) {
        document.activeElement.blur(), A.bind(window, "mousemove", l), A.bind(window, "mouseup", u, !1, !0), l(e);
      }),
      A.bind(
        r.__background,
        "touchstart",
        function(e) {
          if (1 !== e.touches.length) return;
          document.activeElement.blur(),
            A.bind(window, "touchmove", c, !1, !0),
            A.bind(window, "touchend", _, !1, !0),
            (s.__activeTouch = e.targetTouches[0]),
            c(e);
        },
        !1,
        !0
      ),
      A.bind(r.__background, "wheel", function(e) {
        e.preventDefault();
        var t = -e.deltaY >> 10 || 1;
        s.setValue(s.getValue() + t * s.__impliedStep);
      }),
      A.addClass(r.__background, "slider"),
      A.addClass(r.__foreground, "slider-fg"),
      r.updateDisplay(),
      r.__background.appendChild(r.__foreground),
      r.domElement.appendChild(r.__background),
      r
    );
  }
  var P,
    U = (w(G, (P = b)),
    (G.prototype.fire = function() {
      this.__onChange && this.__onChange.call(this, this.getValue()),
        this.getValue().call(this.object),
        this.__onFinishChange && this.__onFinishChange.call(this, this.getValue());
    }),
    G);
  function G(e, t, n) {
    var i,
      o = C((i = P.call(this, e, t) || this));
    return (
      (i.__button = document.createElement("div")),
      (i.__button.innerHTML = void 0 === n ? "Fire" : n),
      A.bind(i.__button, "click", function(e) {
        return (
          e.preventDefault(),
          o.fire(),
          A.addClass(o.__button.parentElement.parentElement.parentElement, "function--active"),
          setTimeout(function() {
            A.removeClass(o.__button.parentElement.parentElement.parentElement, "function--active");
          }, 100),
          !1
        );
      }),
      A.addClass(i.__button, "button"),
      i.domElement.appendChild(i.__button),
      i
    );
  }
  var j,
    z = (w(X, (j = b)),
    (X.prototype.fire = function() {
      this.__onChange && this.__onChange.call(this),
        this.getValue().call(this.object),
        this.__onFinishChange && this.__onFinishChange.call(this, this.getValue());
    }),
    X);
  function X(e, t, n, i, o) {
    var a,
      r = C((a = j.call(this, e, t) || this));
    (a.__button = document.createElement("div")),
      (a.__button.innerHTML = void 0 === n ? "Fire" : n),
      A.bind(a.__button, "click", function(e) {
        return e.preventDefault(), r.fire(), !1;
      }),
      A.addClass(a.__button, "button");
    var s = 2 * i;
    return (
      (a.__button.style.paddingLeft = s.toString() + "em"), (a.property = o), a.domElement.appendChild(a.__button), a
    );
  }
  var K,
    W = (w(Y, (K = b)),
    (Y.prototype.updateDisplay = function() {
      var t = p(this.getValue());
      if (!1 !== t) {
        var n = !1;
        h.each(
          f.COMPONENTS,
          function(e) {
            if (!h.isUndefined(t[e]) && !h.isUndefined(this.__color.__state[e]) && t[e] !== this.__color.__state[e])
              return (n = !0), {};
          },
          this
        ),
          n && h.extend(this.__color.__state, t);
      }
      h.extend(this.__temp.__state, this.__color.__state), (this.__temp.a = 1);
      var e = this.__color.v < 0.5 || 0.5 < this.__color.s ? 255 : 0,
        i = 255 - e;
      h.extend(this.__field_knob.style, {
        marginLeft: 100 * this.__color.s - 7 + "px",
        marginTop: 100 * (1 - this.__color.v) - 7 + "px",
        backgroundColor: this.__temp.toHexString(),
        border: this.__field_knob_border + "rgb(" + e + "," + e + "," + e + ")"
      }),
        (this.__hue_knob.style.marginTop = 100 * (1 - this.__color.h / 360) + "px"),
        (this.__temp.s = 1),
        (this.__temp.v = 1),
        q(this.__saturation_field, "left", "#fff", this.__temp.toHexString()),
        (this.__input.value = this.__color.toString()),
        h.extend(this.__input.style, {
          backgroundColor: this.__color.toHexString(),
          color: "rgb(" + e + "," + e + "," + e + ")",
          textShadow: this.__input_textShadow + "rgba(" + i + "," + i + "," + i + ",.7)"
        });
    }),
    Y);
  function Y(e, t) {
    var n;
    ((n = K.call(this, e, t) || this).__color = new f(n.getValue())), (n.__temp = new f(0));
    var s = C(n);
    (n.domElement = document.createElement("div")),
      A.makeSelectable(n.domElement, !1),
      (n.__selector = document.createElement("div")),
      (n.__selector.className = "selector"),
      (n.__saturation_field = document.createElement("div")),
      (n.__saturation_field.className = "saturation-field"),
      (n.__field_knob = document.createElement("div")),
      (n.__field_knob.className = "field-knob"),
      (n.__field_knob_border = "2px solid "),
      (n.__hue_knob = document.createElement("div")),
      (n.__hue_knob.className = "hue-knob"),
      (n.__hue_field = document.createElement("div")),
      (n.__hue_field.className = "hue-field"),
      (n.__input = document.createElement("input")),
      (n.__input.type = "text"),
      (n.__input_textShadow = "0 1px 1px "),
      A.bind(
        n.__input,
        "keydown",
        function(e) {
          13 === e.keyCode && d.call(this);
        },
        !1,
        !0
      ),
      A.bind(n.__input, "blur", d, !1, !0),
      A.bind(
        n.__selector,
        "mousedown",
        function() {
          A.addClass(this, "drag").bind(window, "mouseup", function() {
            A.removeClass(s.__selector, "drag");
          });
        },
        !1,
        !0
      ),
      A.bind(
        n.__selector,
        "touchstart",
        function() {
          A.addClass(this, "drag").bind(
            window,
            "touchend",
            function() {
              A.removeClass(s.__selector, "drag");
            },
            !1,
            !0
          );
        },
        !1,
        !0
      );
    var i = document.createElement("div");
    function o(e) {
      c(e),
        A.bind(window, "mousemove", c),
        A.bind(window, "touchmove", c),
        A.bind(window, "mouseup", r, !1, !0),
        A.bind(window, "touchend", r, !1, !0);
    }
    function a(e) {
      _(e),
        A.bind(window, "mousemove", _),
        A.bind(window, "touchmove", _),
        A.bind(window, "mouseup", l, !1, !0),
        A.bind(window, "touchend", l, !1, !0);
    }
    function r() {
      A.unbind(window, "mousemove", c),
        A.unbind(window, "touchmove", c),
        A.unbind(window, "mouseup", r),
        A.unbind(window, "touchend", r),
        u();
    }
    function l() {
      A.unbind(window, "mousemove", _),
        A.unbind(window, "touchmove", _),
        A.unbind(window, "mouseup", l),
        A.unbind(window, "touchend", l),
        u();
    }
    function d() {
      var e = p(this.value);
      !1 !== e ? ((s.__color.__state = e), s.setValue(s.__color.toOriginal())) : (this.value = s.__color.toString());
    }
    function u() {
      s.__onFinishChange && s.__onFinishChange.call(s, s.__color.toOriginal());
    }
    function c(e) {
      -1 === e.type.indexOf("touch") && e.preventDefault();
      var t = s.__saturation_field.getBoundingClientRect(),
        n = (e.touches && e.touches[0]) || e,
        i = n.clientX,
        o = n.clientY,
        a = (i - t.left) / (t.right - t.left),
        r = 1 - (o - t.top) / (t.bottom - t.top);
      return (
        1 < r ? (r = 1) : r < 0 && (r = 0),
        1 < a ? (a = 1) : a < 0 && (a = 0),
        (s.__color.v = r),
        (s.__color.s = a),
        s.setValue(s.__color.toOriginal()),
        !1
      );
    }
    function _(e) {
      -1 === e.type.indexOf("touch") && e.preventDefault();
      var t = s.__hue_field.getBoundingClientRect(),
        n = 1 - (((e.touches && e.touches[0]) || e).clientY - t.top) / (t.bottom - t.top);
      return 1 < n ? (n = 1) : n < 0 && (n = 0), (s.__color.h = 360 * n), s.setValue(s.__color.toOriginal()), !1;
    }
    return (
      h.extend(n.__selector.style, {
        width: "122px",
        height: "102px",
        padding: "3px",
        backgroundColor: "#222",
        boxShadow: "0px 1px 3px rgba(0,0,0,0.3)"
      }),
      h.extend(n.__field_knob.style, {
        position: "absolute",
        width: "12px",
        height: "12px",
        border: n.__field_knob_border + (n.__color.v < 0.5 ? "#fff" : "#000"),
        boxShadow: "0px 1px 3px rgba(0,0,0,0.5)",
        borderRadius: "12px",
        zIndex: 1
      }),
      h.extend(n.__hue_knob.style, {
        position: "absolute",
        width: "15px",
        height: "2px",
        borderRight: "4px solid #fff",
        zIndex: 1
      }),
      h.extend(n.__saturation_field.style, {
        width: "100px",
        height: "100px",
        border: "1px solid #555",
        marginRight: "3px",
        display: "inline-block",
        cursor: "pointer"
      }),
      h.extend(i.style, { width: "100%", height: "100%", background: "none" }),
      q(i, "top", "rgba(0,0,0,0)", "#000"),
      h.extend(n.__hue_field.style, {
        width: "15px",
        height: "100px",
        border: "1px solid #555",
        cursor: "ns-resize",
        position: "absolute",
        top: "3px",
        right: "3px"
      }),
      (function(e) {
        (e.style.background = ""),
          (e.style.cssText +=
            "background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);"),
          (e.style.cssText +=
            "background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"),
          (e.style.cssText +=
            "background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"),
          (e.style.cssText +=
            "background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"),
          (e.style.cssText +=
            "background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);");
      })(n.__hue_field),
      h.extend(n.__input.style, {
        outline: "none",
        textAlign: "center",
        color: "#fff",
        border: 0,
        fontWeight: "bold",
        textShadow: n.__input_textShadow + "rgba(0,0,0,0.7)"
      }),
      A.bind(n.__saturation_field, "mousedown", o),
      A.bind(n.__saturation_field, "touchstart", o),
      A.bind(n.__field_knob, "mousedown", o),
      A.bind(n.__field_knob, "touchstart", o),
      A.bind(n.__hue_field, "mousedown", a),
      A.bind(n.__hue_field, "touchstart", a),
      n.__saturation_field.appendChild(i),
      n.__selector.appendChild(n.__field_knob),
      n.__selector.appendChild(n.__saturation_field),
      n.__selector.appendChild(n.__hue_field),
      n.__hue_field.appendChild(n.__hue_knob),
      n.domElement.appendChild(n.__input),
      n.domElement.appendChild(n.__selector),
      n.updateDisplay(),
      n
    );
  }
  var J = ["-moz-", "-o-", "-webkit-", "-ms-", ""];
  function q(t, n, i, o) {
    (t.style.background = ""),
      h.each(J, function(e) {
        t.style.cssText += "background: " + e + "linear-gradient(" + n + ", " + i + " 0%, " + o + " 100%); ";
      });
  }
  var $,
    Q = (w(Z, ($ = b)),
    (Z.prototype.fire = function(e) {
      this.__onChange && this.__onChange.call(this, e),
        this.getValue().call(this.object, e),
        this.__onFinishChange && this.__onFinishChange.call(this, e);
    }),
    Z);
  function Z(e, t) {
    var n,
      i = C((n = $.call(this, e, t) || this));
    return (
      (n.__input = document.createElement("input")),
      n.__input.setAttribute("type", "file"),
      A.bind(n.__input, "change", function(e) {
        var t = new FileReader();
        t.addEventListener("load", function() {
          i.fire(t.result);
        });
        var n = e.target.files[0];
        t.readAsDataURL(n);
      }),
      n.domElement.appendChild(n.__input),
      n
    );
  }
  function ee(n, i, o) {
    var a = Math.round,
      r = a(window.devicePixelRatio || 1),
      e = 160 * r,
      t = 60 * r,
      s = 3 * r,
      l = 3 * r,
      d = 154 * r,
      u = 54 * r,
      c = document.createElement("canvas");
    (c.width = e), (c.height = t);
    var _ = c.getContext("2d");
    return (
      (_.font = "bold " + 9 * r + "px Helvetica,Arial,sans-serif"),
      (_.textBaseline = "top"),
      (_.fillStyle = i),
      _.fillRect(0, 0, e, t),
      (_.fillStyle = n),
      _.fillRect(s, l, d, u),
      (_.fillStyle = i),
      (_.globalAlpha = 0.9),
      _.fillRect(s, l, d, u),
      {
        dom: c,
        update: function(e, t) {
          (_.globalAlpha = 1),
            (_.fillStyle = n),
            _.drawImage(c, s + r, l, d - r, u, s, l, d - r, u),
            _.fillRect(s + d - r, l, r, u),
            (_.fillStyle = i),
            (_.globalAlpha = 0.9),
            _.fillRect(s + d - r, l, r, a((1 - e / t) * u)),
            "line" === o && _.fillRect(s + d - r, a((1 - e / t) * u) + r + 3, r, a((e / t) * u));
        }
      }
    );
  }
  var te,
    ne = (w(ie, (te = b)),
    (ie.prototype.updateDisplay = function() {
      var e = this.getValue();
      return (
        this.period < 1 && e !== this.prevValue
          ? this.__panel.update(e, this.max)
          : Date.now() - this.lastUpdate > this.period &&
            (this.__panel.update(e, this.max), (this.lastUpdate = 2 * Date.now() - this.lastUpdate - this.period)),
        (this.prevValue = e),
        te.prototype.updateDisplay.call(this)
      );
    }),
    ie);
  function ie(e, t, n) {
    var i;
    return (
      ((i = te.call(this, e, t) || this).max = n.max),
      (i.period = n.period),
      (i.prevValue = i.getValue()),
      (i.lastUpdate = Date.now()),
      (i.__panel = new ee(n.fgColor, n.bgColor, n.type)),
      i.domElement.appendChild(i.__panel.dom),
      i
    );
  }
  var oe,
    ae = (w(re, (oe = b)), re);
  function re(e, t) {
    var n;
    return (n = oe.call(this, e, t) || this), e.constructor(C(n)), n;
  }
  "undefined" != typeof globalThis
    ? globalThis
    : "undefined" != typeof window
    ? window
    : "undefined" != typeof global
    ? global
    : "undefined" != typeof self && self;
  function se(e) {
    (this.data = e),
      (this.len = this.data.length),
      (this.pos = 0),
      (this.readByte = function() {
        if (this.pos >= this.data.length) throw new Error("Attempted to read past end of stream.");
        return e instanceof Uint8Array ? e[this.pos++] : 255 & e.charCodeAt(this.pos++);
      }),
      (this.readBytes = function(e) {
        for (var t = [], n = 0; n < e; n++) t.push(this.readByte());
        return t;
      }),
      (this.read = function(e) {
        for (var t = "", n = 0; n < e; n++) t += String.fromCharCode(this.readByte());
        return t;
      }),
      (this.readUnsigned = function() {
        var e = this.readBytes(2);
        return (e[1] << 8) + e[0];
      });
  }
  function le(e) {
    return e.reduce(function(e, t) {
      return 2 * e + t;
    }, 0);
  }
  function de(e) {
    for (var t = [], n = 7; 0 <= n; n--) t.push(!!(e & (1 << n)));
    return t;
  }
  function ue(o, i) {
    function a(e) {
      for (var t = [], n = 0; n < e; n++) t.push(o.readBytes(3));
      return t;
    }
    function r() {
      var e,
        t,
        n,
        i = 0;
      t = new Uint8Array(8192);
      do {
        for (e = o.readByte(); i + e > t.length; ) (n = void 0), (n = new Uint8Array(t.length + 8192)).set(t), (t = n);
        t.set(o.readBytes(e), i), (i += e);
      } while (0 !== e);
      return t.subarray(0, i);
    }
    i || (i = {});
    var t = function() {
      var e = {};
      switch (((e.sentinel = o.readByte()), String.fromCharCode(e.sentinel))) {
        case "!":
          (e.type = "ext"),
            (function(e) {
              var t, n;
              switch (((e.label = o.readByte()), e.label)) {
                case 249:
                  (e.extType = "gce"),
                    (function(e) {
                      o.readByte();
                      var t = de(o.readByte());
                      (e.reserved = t.splice(0, 3)),
                        (e.disposalMethod = le(t.splice(0, 3))),
                        (e.userInput = t.shift()),
                        (e.transparencyGiven = t.shift()),
                        (e.delayTime = o.readUnsigned()),
                        (e.transparencyIndex = o.readByte()),
                        (e.terminator = o.readByte()),
                        i.gce && i.gce(e);
                    })(e);
                  break;
                case 254:
                  (e.extType = "com"), ((n = e).comment = r()), i.com && i.com(n);
                  break;
                case 1:
                  (e.extType = "pte"),
                    (function(e) {
                      o.readByte();
                      (e.ptHeader = o.readBytes(12)), (e.ptData = r()), i.pte && i.pte(e);
                    })(e);
                  break;
                case 255:
                  (e.extType = "app"),
                    (function(e) {
                      var t;
                      o.readByte();
                      switch (((e.identifier = o.read(8)), (e.authCode = o.read(3)), e.identifier)) {
                        case "NETSCAPE":
                          !(function(e) {
                            o.readByte();
                            (e.unknown = o.readByte()),
                              (e.iterations = o.readUnsigned()),
                              (e.terminator = o.readByte()),
                              i.app && i.app.NETSCAPE && i.app.NETSCAPE(e);
                          })(e);
                          break;
                        default:
                          ((t = e).appData = r()), i.app && i.app[t.identifier] && i.app[t.identifier](t);
                      }
                    })(e);
                  break;
                default:
                  (e.extType = "unknown"), ((t = e).data = r()), i.unknown && i.unknown(t);
              }
            })(e);
          break;
        case ",":
          (e.type = "img"),
            (function(e) {
              (e.leftPos = o.readUnsigned()),
                (e.topPos = o.readUnsigned()),
                (e.width = o.readUnsigned()),
                (e.height = o.readUnsigned());
              var t = de(o.readByte());
              (e.lctFlag = t.shift()),
                (e.interlaced = t.shift()),
                (e.sorted = t.shift()),
                (e.reserved = t.splice(0, 2)),
                (e.lctSize = le(t.splice(0, 3))),
                e.lctFlag && (e.lct = a(1 << (e.lctSize + 1))),
                (e.lzwMinCodeSize = o.readByte());
              var n = r();
              (e.pixels = _e(e.lzwMinCodeSize, n)),
                e.interlaced &&
                  (e.pixels = (function(e, t) {
                    for (
                      var n,
                        i,
                        o,
                        a = new Array(e.length),
                        r = e.length / t,
                        s = [0, 4, 2, 1],
                        l = [8, 8, 4, 2],
                        d = 0,
                        u = 0;
                      u < 4;
                      u++
                    )
                      for (var c = s[u]; c < r; c += l[u])
                        (n = c),
                          (i = d),
                          void 0,
                          (o = e.slice(i * t, (i + 1) * t)),
                          a.splice.apply(a, [n * t, t].concat(o)),
                          d++;
                    return a;
                  })(e.pixels, e.width)),
                i.img && i.img(e);
            })(e);
          break;
        case ";":
          (e.type = "eof"), i.eof && i.eof(e);
          break;
        default:
          throw new Error("Unknown block: 0x" + e.sentinel.toString(16));
      }
      "eof" !== e.type && setTimeout(t, 0);
    };
    !(function() {
      var e = {};
      if (((e.sig = o.read(3)), (e.ver = o.read(3)), "GIF" !== e.sig)) throw new Error("Not a GIF file.");
      (e.width = o.readUnsigned()), (e.height = o.readUnsigned());
      var t = de(o.readByte());
      (e.gctFlag = t.shift()),
        (e.colorRes = le(t.splice(0, 3))),
        (e.sorted = t.shift()),
        (e.gctSize = le(t.splice(0, 3))),
        (e.bgColor = o.readByte()),
        (e.pixelAspectRatio = o.readByte()),
        e.gctFlag && (e.gct = a(1 << (e.gctSize + 1))),
        i.hdr && i.hdr(e);
    })(),
      setTimeout(t, 0);
  }
  var ce,
    _e = function(e, i) {
      function t(e) {
        for (var t = 0, n = 0; n < e; n++) i[d >> 3] & (1 << (7 & d)) && (t |= 1 << n), d++;
        return t;
      }
      function n(e, t) {
        for (var n, i, o = g[t].byteLength + 1; v + o > m.length; )
          (i = void 0), (n = m.length + p), (i = new Uint8Array(n)).set(m), (m = i), (p <<= 1);
        var a = m.subarray(v, v + o);
        a.set(g[t]), (a[o - 1] = g[e][0]), (v += o), g.push(a);
      }
      var o,
        a,
        r,
        s,
        l,
        d = 0,
        u = 1 << e,
        c = 1 + u,
        _ = e + 1,
        h = 4096,
        p = 4096,
        f = new Uint8Array(h),
        m = new Uint8Array(p),
        g = [],
        v = 0,
        b = 0;
      for (
        !(function() {
          for (var e = 0; e < u; e++) (g[e] = new Uint8Array(1)), (g[e][0] = e);
          (g[u] = new Uint8Array(0)), (g[c] = null);
        })();
        ;

      )
        if (((a = o), (o = t(_)) !== u)) {
          if (o === c) break;
          if (o < g.length) a !== u && n(o, a);
          else {
            if (o !== g.length) throw new Error("Invalid LZW code.");
            n(a, a);
          }
          for (var y = g[o].length; b + y > f.length; )
            (s = void 0), (r = f.length + h), (s = new Uint8Array(r)).set(f), (f = s), (h <<= 1);
          f.set(g[o], b), (b += y), g.length === 1 << _ && _ < 12 && _++;
        } else void 0, (l = 2 + u), g.splice(l, g.length - l), (_ = e + 1), (v = 0);
      return f.subarray(0, b);
    },
    he = ((function(e) {
      var J, q;
      e.exports = ((J = se),
      (q = ue),
      function(e) {
        var i,
          l,
          d = { vp_l: 0, vp_t: 0, vp_w: null, vp_h: null, c_w: null, c_h: null };
        for (var t in e) d[t] = e[t];
        d.vp_w && d.vp_h && (d.is_vp = !0);
        var o = null,
          n = !1,
          u = null,
          a = null,
          r = null,
          c = null,
          _ = null,
          h = null,
          p = null,
          s = !0,
          f = !1,
          m = [],
          g = [],
          v = d.gif;
        void 0 === d.gif && d.url && ((v = document.createElement("img")).src = d.url),
          void 0 === d.auto_play &&
            (d.auto_play = !v.getAttribute("data-autoplay") || "1" == v.getAttribute("data-autoplay"));
        var b,
          y,
          w,
          C,
          E = d.hasOwnProperty("on_end") ? d.on_end : null,
          x = d.hasOwnProperty("loop_delay") ? d.loop_delay : 0,
          S = d.hasOwnProperty("loop_mode") ? d.loop_mode : "auto",
          k = !d.hasOwnProperty("draw_while_loading") || d.draw_while_loading,
          A = !!k && (!d.hasOwnProperty("show_progress_bar") || d.show_progress_bar),
          T = d.hasOwnProperty("progressbar_height") ? d.progressbar_height : 25,
          L = d.hasOwnProperty("progressbar_background_color")
            ? d.progressbar_background_color
            : "rgba(255,255,255,0.4)",
          O = d.hasOwnProperty("progressbar_foreground_color") ? d.progressbar_foreground_color : "rgba(255,0,22,.8)",
          B = function() {
            (_ = r), (h = r = a = u = null);
          },
          V = function() {
            try {
              q(i, {
                hdr: j(D),
                gce: j(H),
                com: j(G),
                app: { NETSCAPE: j(G) },
                img: j(M, !0),
                eof: function(e) {
                  F(),
                    U(!1),
                    (d.c_w && d.c_h) || ((b.width = l.width * X()), (b.height = l.height * X())),
                    P.init(),
                    (n = !1),
                    W && W(o, v);
                }
              });
            } catch (e) {
              I("parse");
            }
          },
          N = function(e, t) {
            (b.width = e * X()),
              (b.height = t * X()),
              (w.style.minWidth = e * X() + "px"),
              (C.width = e),
              (C.height = t),
              (C.style.width = e + "px"),
              (C.style.height = t + "px"),
              C.getContext("2d").setTransform(1, 0, 0, 1, 0, 0);
          },
          R = function(e, t, n) {
            if (n && A) {
              var i,
                o,
                a,
                r,
                s = T;
              d.is_vp
                ? (r = f
                    ? ((a = (d.vp_t + d.vp_h - s) / X()),
                      (s /= X()),
                      (i = d.vp_l / X()),
                      (o = i + (e / t) * (d.vp_w / X())),
                      b.width / X())
                    : ((a = d.vp_t + d.vp_h - s), (s = s), (i = d.vp_l), (o = i + (e / t) * d.vp_w), b.width))
                : ((a = (b.height - s) / (f ? X() : 1)),
                  (o = ((e / t) * b.width) / (f ? X() : 1)),
                  (r = b.width / (f ? X() : 1)),
                  (s /= f ? X() : 1)),
                (y.fillStyle = L),
                y.fillRect(o, a, r - o, s),
                (y.fillStyle = O),
                y.fillRect(0, a, o, s);
            }
          },
          I = function(e) {
            (o = e),
              (l = { width: v.width, height: v.height }),
              (m = []),
              (y.fillStyle = "black"),
              y.fillRect(0, 0, d.c_w ? d.c_w : l.width, d.c_h ? d.c_h : l.height),
              (y.strokeStyle = "red"),
              (y.lineWidth = 3),
              y.moveTo(0, 0),
              y.lineTo(d.c_w ? d.c_w : l.width, d.c_h ? d.c_h : l.height),
              y.moveTo(0, d.c_h ? d.c_h : l.height),
              y.lineTo(d.c_w ? d.c_w : l.width, 0),
              y.stroke();
          },
          D = function(e) {
            N((l = e).width, l.height);
          },
          H = function(e) {
            F(), B(), (u = e.transparencyGiven ? e.transparencyIndex : null), (a = e.delayTime), (r = e.disposalMethod);
          },
          F = function() {
            if (h) {
              var e = { data: h.getImageData(0, 0, l.width, l.height), delay: a };
              d.includeDataURL && (e.dataURL = C.toDataURL()), m.push(e), g.push({ x: 0, y: 0 });
            }
          },
          M = function(e) {
            h || (h = C.getContext("2d"));
            var t = m.length,
              n = e.lctFlag ? e.lct : l.gct;
            0 < t &&
              (3 === _
                ? null !== c
                  ? h.putImageData(m[c].data, 0, 0)
                  : h.clearRect(p.leftPos, p.topPos, p.width, p.height)
                : (c = t - 1),
              2 === _ && h.clearRect(p.leftPos, p.topPos, p.width, p.height));
            for (var i = h.getImageData(e.leftPos, e.topPos, e.width, e.height), o = 0; o < e.pixels.length; o++) {
              var a = e.pixels[o];
              if (a !== u) {
                var r = n[a],
                  s = 4 * o;
                (i.data[s] = r[0]), (i.data[1 + s] = r[1]), (i.data[2 + s] = r[2]), (i.data[3 + s] = 255);
              }
            }
            h.putImageData(i, e.leftPos, e.topPos),
              f || (y.scale(X(), X()), (f = !0)),
              k && (y.drawImage(C, 0, 0), (k = d.auto_play)),
              (p = e);
          },
          P = (function() {
            var a = -1,
              e = 0,
              r = function(e) {
                (a += e), n();
              },
              t = (function() {
                var n = !1,
                  i = function() {
                    null !== E && E(v), e++, !1 !== S || e < 0 ? o() : (s = n = !1);
                  },
                  o = function() {
                    if ((n = s)) {
                      r(1);
                      var e = 10 * m[a].delay;
                      e || (e = 100);
                      var t = (a + 1 + m.length) % m.length;
                      0 === t ? ((e += x), setTimeout(i, e)) : setTimeout(o, e);
                    }
                  };
                return function() {
                  n || setTimeout(o, 0);
                };
              })(),
              n = function() {
                var e;
                (a = parseInt(a, 10)) > m.length - 1 && (a = 0),
                  a < 0 && (a = 0),
                  (e = g[a]),
                  C.getContext("2d").putImageData(m[a].data, e.x, e.y),
                  (y.globalCompositeOperation = "copy"),
                  y.drawImage(C, 0, 0);
              };
            return {
              init: function() {
                o || ((d.c_w && d.c_h) || y.scale(X(), X()), d.auto_play ? t() : ((a = 0), n()));
              },
              step: t,
              play: function() {
                (s = !0), t();
              },
              pause: function() {
                s = !1;
              },
              playing: s,
              move_relative: r,
              current_frame: function() {
                return a;
              },
              frames: function() {
                return m;
              },
              length: function() {
                return m.length;
              },
              move_to: function(e) {
                (a = e), n();
              }
            };
          })(),
          U = function(e) {
            R(i.pos, i.data.length, e);
          },
          G = function() {},
          j = function(t, n) {
            return function(e) {
              t(e), U(n);
            };
          },
          z = function() {
            var e = v.parentNode,
              t = document.createElement("div");
            (b = document.createElement("canvas")),
              (y = b.getContext("2d")),
              (w = document.createElement("div")),
              (C = document.createElement("canvas")),
              (t.width = b.width = v.width),
              (t.height = b.height = v.height),
              (w.style.minWidth = v.width + "px"),
              (t.className = "jsgif"),
              (w.className = "jsgif_toolbar"),
              t.appendChild(b),
              t.appendChild(w),
              e && (e.insertBefore(t, v), e.removeChild(v)),
              d.c_w && d.c_h && N(d.c_w, d.c_h),
              (K = !0);
          },
          X = function() {
            return d.max_width && l && l.width > d.max_width ? d.max_width / l.width : 1;
          },
          K = !1,
          W = !1,
          Y = function(e) {
            return !(n || ((W = e || !1), (n = !0), (m = []), B(), (p = h = _ = c = null)));
          };
        return {
          play: P.play,
          pause: P.pause,
          move_relative: P.move_relative,
          move_to: P.move_to,
          get_frames: function() {
            return P.frames();
          },
          get_playing: function() {
            return s;
          },
          get_canvas: function() {
            return b;
          },
          get_canvas_scale: function() {
            return X();
          },
          get_loading: function() {
            return n;
          },
          get_auto_play: function() {
            return d.auto_play;
          },
          get_length: function() {
            return P.length();
          },
          get_current_frame: function() {
            return P.current_frame();
          },
          load_url: function(e, t) {
            if (Y(t)) {
              var n = new XMLHttpRequest();
              n.open("GET", e, !0),
                "overrideMimeType" in n
                  ? n.overrideMimeType("text/plain; charset=x-user-defined")
                  : "responseType" in n
                  ? (n.responseType = "arraybuffer")
                  : n.setRequestHeader("Accept-Charset", "x-user-defined"),
                (n.onloadstart = function() {
                  K || z();
                }),
                (n.onload = function(e) {
                  200 != this.status && I("xhr - response"),
                    "response" in this ||
                      (this.response = new VBArray(this.responseText)
                        .toArray()
                        .map(String.fromCharCode)
                        .join(""));
                  var t = this.response;
                  t instanceof ArrayBuffer && (t = new Uint8Array(t)), (i = new J(t)), setTimeout(V, 0);
                }),
                (n.onprogress = function(e) {
                  e.lengthComputable && R(e.loaded, e.total, !0);
                }),
                (n.onerror = function() {
                  I("xhr");
                }),
                n.send();
            }
          },
          load: function(e) {
            this.load_url(v.getAttribute("data-animated-src") || v.src, e);
          },
          load_raw: function(e, t) {
            Y(t) && (K || z(), (i = new J(e)), setTimeout(V, 0));
          },
          set_frame_offset: function(e, t) {
            g[e] ? (void 0 !== t.x && (g[e].x = t.x), void 0 !== t.y && (g[e].y = t.y)) : (g[e] = t);
          }
        };
      });
    })((ce = { exports: {} }), ce.exports),
    ce.exports);
  navigator.getUserMedia =
    navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
  var pe,
    fe = (function(d) {
      function e(e, t, n) {
        var i, o;
        i = d.call(this, e, t) || this;
        var a = !1;
        function r(e) {
          e.preventDefault(), e.target.classList.add("dragover");
        }
        function s(e) {
          e.target.classList.remove("dragover");
        }
        function l(e) {
          e.target.classList.remove("dragover");
          var t = e.originalEvent.dataTransfer.files[0];
          (t.isSaved = !1), this.parseFile(t);
        }
        return (
          (o = n.defaults ? ((a = n.disableVideo), n.defaults) : n),
          (i.__controlContainer = document.createElement("div")),
          A.addClass(i.__controlContainer, "image-picker"),
          (i.videoStreams = []),
          (i.__selectedInputContainer = i.__controlContainer.appendChild(document.createElement("div"))),
          A.addClass(i.__selectedInputContainer, "selected-image"),
          (i.__swatches = i.__controlContainer.appendChild(document.createElement("div"))),
          A.addClass(i.__swatches, "image-swatches"),
          (i.__img = i.__selectedInputContainer.appendChild(document.createElement("img"))),
          (i.__img.crossOrigin = "anonymous"),
          (i.__video = i.__selectedInputContainer.appendChild(document.createElement("video"))),
          (i.__input = i.__controlContainer.appendChild(document.createElement("input"))),
          (i.__swatchButtons = i.__swatches.appendChild(document.createElement("div"))),
          A.addClass(i.__swatchButtons, "swatch-buttons"),
          (i.__swatchImages = i.__swatches.appendChild(document.createElement("div"))),
          (i.__disableVideo = a),
          A.addClass(i.__swatchImages, "swatch-images"),
          (i.__useCamera = navigator.getUserMedia && !a),
          i.__useCamera &&
            ((i.__camera = i.__swatchButtons.appendChild(document.createElement("div"))),
            (i.__cameraTitle = i.__camera.appendChild(document.createElement("span"))),
            (i.__cameraTitle.innerHTML = "Video"),
            (i.__cameraIcon = i.__camera.appendChild(document.createElement("div"))),
            A.addClass(i.__cameraIcon, "camera-icon"),
            A.addClass(i.__camera, "camera-button")),
          (i.__plus = i.__swatchButtons.appendChild(document.createElement("div"))),
          (i.__plusTitle = i.__plus.appendChild(document.createElement("span"))),
          (i.__plusTitle.innerHTML = "Image"),
          (i.__plusIcon = i.__plus.appendChild(document.createElement("div"))),
          A.addClass(i.__plusIcon, "new-image-icon"),
          A.addClass(i.__plus, "new-image-button"),
          o.forEach(function(e) {
            i.addSwatch(e.src, e.videoSrc);
          }),
          (i.__video.className = i.__img.className = "content"),
          (i.__video.crossOrigin = "anonymous"),
          i.__video.setAttribute("playsinline", !0),
          (i.__input.type = "file"),
          (i.__gifImg = i.__selectedInputContainer.appendChild(document.createElement("img"))),
          (i.__gifImg.crossOrigin = "anonymous"),
          A.addClass(i.__gifImg, "content gif-img"),
          (i.__glGif = new he({ gif: i.__gifImg })),
          (i.__gifNeedsInitializing = !0),
          i.initializeValue(),
          i.__useCamera &&
            A.bind(
              i.__camera,
              "click",
              function() {
                var t = this;
                navigator.mediaDevices
                  .getUserMedia({ video: !0 })
                  .then(function(e) {
                    t.killStream(),
                      (t.videoStream = e),
                      t.setValue({ type: "video-stream", value: e, domElement: t.__video });
                  })
                  .catch(function() {
                    t.killStream();
                  });
              }.bind(C(i))
            ),
          A.bind(
            i.__plus,
            "click",
            function() {
              this.__input.click();
            }.bind(C(i))
          ),
          A.bind(
            i.__input,
            "change",
            function(e) {
              var t = e.target.files[0];
              (t.isSaved = !1), this.parseFile(t);
            }.bind(C(i))
          ),
          A.bind(i.__img, "dragover", r.bind(C(i))),
          A.bind(i.__img, "dragleave", s.bind(C(i))),
          A.bind(i.__img, "drop", l.bind(C(i))),
          A.bind(i.__video, "dragover", r.bind(C(i))),
          A.bind(i.__video, "dragleave", s.bind(C(i))),
          A.bind(i.__video, "drop", l.bind(C(i))),
          i.domElement.appendChild(i.__controlContainer),
          i
        );
      }
      w(e, d);
      var t = e.prototype;
      return (
        (t.killStream = function() {
          this.videoStream &&
            this.videoStream.getTracks().forEach(function(e) {
              return e.stop();
            });
        }),
        (t.destruct = function() {
          this.killStream();
        }),
        (t.initializeValue = function() {
          var e = this.getValue();
          e &&
            ("gif" === e.type
              ? this.__gifNeedsInitializing
                ? this.setImage(e.url, !0)
                : this.setValue({ url: e.url, type: e.type, domElement: this.__glGif.get_canvas() })
              : "image" === e.type
              ? this.setValue({ url: e.url, type: e.type, domElement: this.__img })
              : "video" === e.type && this.setValue({ url: e.url, type: e.type, domElement: this.__video }));
        }),
        (t.updateDisplay = function() {
          var e = this.getValue();
          e &&
            ("image" === e.type
              ? this.setImage(e.url, !1)
              : "gif" === e.type
              ? this.setImage(e.url, !0)
              : "video" === e.type
              ? this.setVideo(e.url)
              : "video-stream" === e.type && this.setVideo(e.value));
        }),
        (t.parseFile = function(e) {
          var t = e.type.split("/")[0];
          if ((this.__glGif && this.__glGif.pause(), "image" === t)) {
            var n = e.urlOverride || URL.createObjectURL(e),
              i = "gif" === e.type.split("/")[1] || e.animatedOverride;
            !this.__disableVideo && i
              ? this.__gifNeedsInitializing
                ? this.setImage(n, !0)
                : this.setValue({ url: n, type: "gif", domElement: this.__glGif.get_canvas() })
              : i || (this.setValue({ url: n, type: "image", domElement: this.__img }), this.setImage(n, !1));
          } else
            this.__disableVideo ||
              "video" !== t ||
              (this.setValue({ url: url, type: "video", domElement: this.__video }), this.setVideo());
        }),
        (t.setImage = function(t, e) {
          var n = this;
          this.__skipSetImage
            ? (this.__skipSetImage = !1)
            : ((this.__isVideo = !1),
              (this.__isAnimated = e)
                ? ((this.__img.src = ""),
                  (this.__img.style.display = "none"),
                  (this.__gifImg.src = t),
                  this.__glGif.get_canvas() && (this.__glGif.get_canvas().style.display = "block"),
                  this.__glGif.load(function(e) {
                    e ||
                      (n.__glGif.play().catch(function(e) {
                        return console.log(e);
                      }),
                      n.__gifNeedsInitializing &&
                        ((n.__gifNeedsInitializing = !1),
                        (n.__skipSetImage = !0),
                        n.setValue({ url: t, type: "gif", domElement: n.__glGif.get_canvas() })));
                  }))
                : (this.__glGif.get_canvas() && (this.__glGif.get_canvas().style.display = "none"),
                  (this.__img.src = t),
                  (this.__img.style.display = "block")),
              (this.__video.style.display = "none"),
              (this.__video.src = ""));
        }),
        (t.setVideo = function() {
          var e = this.getValue();
          "video-stream" === e.type
            ? (this.__video.srcObject = e.value)
            : (this.killStream(), (this.__video.src = e.url)),
            (this.__isVideo = !0),
            (this.__isAnimated = !0),
            (this.__video.loop = !0),
            (this.__video.volume = 0),
            this.__video.play().catch(function(e) {
              console.log(e, e.message, e.name);
            }),
            (this.__img.src = "data:image/gif;base64,R0lGODlhAQABAAAAACwAAAAAAQABAAA="),
            (this.__img.style.display = "none"),
            this.__glGif.get_canvas() && (this.__glGif.get_canvas().style.display = "none"),
            (this.__video.style.display = "block");
        }),
        (t.addSwatch = function(e, t) {
          var n = this,
            i = this.__swatchImages.appendChild(document.createElement("img"));
          (i.src = e),
            (i.videoSrc = t),
            (i.className = "swatch"),
            A.bind(i, "click", function() {
              t
                ? n.setValue({ url: t, type: "video", domElement: n.__video })
                : "gif" === e.split(".").pop()
                ? n.__gifNeedsInitializing
                  ? n.setImage(url, !0)
                  : n.setValue({ url: e, type: "gif", domElement: n.__glGif.get_canvas() })
                : n.setValue({ url: e, type: "image", domElement: n.__img });
            });
        }),
        e
      );
    })(b),
    me = (w(ge, (pe = b)),
    (ge.prototype.updateDisplay = function() {
      for (var e = 0; e < this.__inputs.length; e++) if (A.isActive(this.__inputs[e])) return;
      var o = this;
      function a(n) {
        for (
          var e = function(t) {
              if (o.__inputs[t].parentElement === n.target.parentElement) {
                var e = o.getValue().filter(function(e) {
                  return e !== o.__inputs[t].value;
                });
                o.setValue(e);
              }
            },
            t = 0;
          t < o.__inputs.length;
          t++
        )
          e(t);
      }
      function r() {
        if (!o.__changing) {
          o.__changing = !0;
          var e = o.__inputs.map(function(e) {
            return e.value;
          });
          o.setValue(e), (o.__changing = !1);
        }
      }
      function s() {
        o.__onFinishChange && o.__onFinishChange.call(o, o.getValue());
      }
      this.__inputs.forEach(function(e) {
        o.__div.removeChild(e.parentElement);
      }),
        (this.__inputs = []),
        this.getValue().forEach(function(e) {
          var t = document.createElement("div");
          A.addClass(t, "array-input");
          var n = document.createElement("input");
          t.appendChild(n), n.setAttribute("type", "text"), (n.value = e);
          var i = document.createElement("span");
          (i.innerHTML = "&nbsp;"),
            A.addClass(i, "remove-icon"),
            t.appendChild(i),
            A.bind(i, "click", a),
            A.bind(n, "keyup", r),
            A.bind(n, "change", r),
            A.bind(n, "blur", s),
            A.bind(n, "keydown", function(e) {
              13 === e.keyCode && this.blur();
            }),
            o.__div.insertBefore(t, o.__new),
            o.__inputs.push(n);
        });
    }),
    ge);
  function ge(e, t) {
    var n,
      i = C((n = pe.call(this, e, t) || this));
    return (
      (n.__div = document.createElement("div")),
      (n.__inputs = []),
      (n.__new = document.createElement("input")),
      n.__new.setAttribute("type", "text"),
      A.bind(n.__new, "keydown", function(e) {
        13 === e.keyCode && (i.getValue().push(i.__new.value), (i.__new.value = ""), i.updateDisplay());
      }),
      n.__div.appendChild(n.__new),
      n.updateDisplay(),
      n.domElement.appendChild(n.__div),
      n
    );
  }
  var ve =
    '<div id="dg-save" class="dg dialogue">\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n    <input id="dg-local-storage" type="checkbox"> Automatically save values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">\n      The values saved to <code>localStorage</code> will override those passed to <code>dat.GUI</code>\'s constructor.\n      This makes it easier to work incrementally, but <code>localStorage</code> is fragile, and your friends may not see\n      the same values you do.\n    </div>\n  </div>\n</div>\n';
  var be,
    ye = (w(we, (be = b)),
    (we.prototype.updateDisplay = function() {
      this.__vec = this.getValue();
      var e = (function(e, t, n) {
        return [(e[0] - t[0]) / (n[0] - t[0]), (e[1] - t[1]) / (n[1] - t[1])];
      })(this.__vec, this.__min, this.__max);
      h.extend(this.__field_knob.style, { marginLeft: 50 * e[0] - 7 + "px", marginTop: 50 * (1 - e[1]) - 7 + "px" }),
        (this.__temp[0] = 1),
        (this.__temp[1] = 1);
    }),
    we);
  function we(e, t, n, i) {
    var o;
    void 0 === n && (n = [0, 0]),
      void 0 === i && (i = [1, 1]),
      ((o = be.call(this, e, t, { min: n, max: i }) || this).__min = n),
      (o.__max = i),
      (o.__vec = o.getValue()),
      (o.__temp = [0, 0]);
    var s = C(o);
    function a(e) {
      l(e),
        A.bind(window, "mousemove", l),
        A.bind(window, "touchmove", l),
        A.bind(window, "mouseup", r),
        A.bind(window, "touchend", r);
    }
    function r() {
      A.unbind(window, "mousemove", l),
        A.unbind(window, "touchmove", l),
        A.unbind(window, "mouseup", r),
        A.unbind(window, "touchend", r),
        s.__onFinishChange && s.__onFinishChange.call(s, s.__vec);
    }
    function l(e) {
      -1 === e.type.indexOf("touch") && e.preventDefault();
      var t = s.__pos_field.getBoundingClientRect(),
        n = (e.touches && e.touches[0]) || e,
        i = n.clientX,
        o = n.clientY,
        a = (i - t.left) / (t.right - t.left),
        r = 1 - (o - t.top) / (t.bottom - t.top);
      return (
        1 < a ? (a = 1) : a < 0 && (a = 0),
        1 < r ? (r = 1) : r < 0 && (r = 0),
        (s.__vec = (function(e, t, n) {
          return [e[0] * (n[0] - t[0]) + t[0], e[1] * (n[1] - t[1]) + t[1]];
        })([a, r], s.__min, s.__max)),
        s.setValue(s.__vec),
        !1
      );
    }
    return (
      (o.domElement = document.createElement("div")),
      A.makeSelectable(o.domElement, !1),
      (o.__selector = document.createElement("div")),
      (o.__selector.className = "vector-selector"),
      (o.__pos_field = document.createElement("div")),
      (o.__pos_field.className = "saturation-field"),
      (o.__field_knob = document.createElement("div")),
      (o.__field_knob.className = "field-knob"),
      A.bind(o.__selector, "mousedown", function() {
        A.addClass(this, "drag").bind(window, "mouseup", function() {
          A.removeClass(s.__selector, "drag");
        });
      }),
      A.bind(o.__selector, "touchstart", function() {
        A.addClass(this, "drag").bind(window, "touchend", function() {
          A.removeClass(s.__selector, "drag");
        });
      }),
      h.extend(o.__selector.style, {
        width: "52px",
        height: "52px",
        padding: "3px",
        backgroundColor: "#222",
        boxShadow: "0px 1px 3px rgba(0,0,0,0.3)"
      }),
      h.extend(o.__field_knob.style, {
        position: "absolute",
        width: "12px",
        height: "12px",
        borderRadius: "12px",
        zIndex: 1
      }),
      h.extend(o.__pos_field.style, {
        width: "50px",
        height: "50px",
        marginRight: "3px",
        display: "inline-block",
        cursor: "pointer"
      }),
      A.bind(o.__pos_field, "mousedown", a),
      A.bind(o.__pos_field, "touchstart", a),
      A.bind(o.__field_knob, "mousedown", a),
      A.bind(o.__field_knob, "touchstart", a),
      o.__selector.appendChild(o.__field_knob),
      o.__selector.appendChild(o.__pos_field),
      o.domElement.appendChild(o.__selector),
      o.updateDisplay(),
      o
    );
  }
  var Ce,
    Ee = function(e, t, n, i, o) {
      var a = e[t];
      return arguments.length <= 3 && null != n && (h.isArray(n) || h.isObject(n))
        ? new L(e, t, n)
        : h.isNumber(a)
        ? h.isNumber(n) && h.isNumber(i)
          ? h.isNumber(o)
            ? new F(e, t, n, i, o)
            : new F(e, t, n, i)
          : h.isNumber(o)
          ? new I(e, t, { min: n, max: i, step: o })
          : new I(e, t, { min: n, max: i })
        : (h.isArray(a) && 3 <= a.length && a.length <= 4) ||
          (h.isObject(a) && a.h && a.s && a.v) ||
          (h.isString(a) && "#" === a[0] && (4 === a.length || 7 === a.length))
        ? new W(e, t)
        : h.isArray(a) && 2 === a.length
        ? 3 < arguments.length
          ? new ye(e, t, n, i)
          : new ye(e, t)
        : h.isString(a)
        ? new O(e, t)
        : h.isFunction(a) && void 0 !== n
        ? new z(e, t, "", n || 0, i || "Object")
        : h.isFunction(a)
        ? new U(e, t, "")
        : h.isBoolean(a)
        ? new T(e, t)
        : h.isArray(a)
        ? new me(e, t)
        : null;
    },
    xe = (w(Se, (Ce = N)), Se);
  function Se(e, t, n) {
    var i,
      o = C((i = Ce.call(this, e, t, n) || this));
    function a() {
      var e;
      null !== o.__animationMode &&
        ("sine" === o.__animationMode
          ? (e = Math.sin(Date.now() / 1e3) / 2 + 0.5)
          : "saw" === o.__animationMode && (e = (Date.now() / 2e3) % 1),
        void 0 !== o.__min && void 0 !== o.__max ? o.setValue((o.__max - o.__min) * e + o.__min) : o.setValue(e),
        requestAnimationFrame(a));
    }
    function r() {
      o.__animationMode = null;
    }
    return (
      A.addClass(i.domElement, "button-container"),
      (i.__animationMode = null),
      (i.__sineButton = document.createElement("button")),
      A.addClass(i.__sineButton, "sine-button"),
      (i.__sawButton = document.createElement("button")),
      A.addClass(i.__sawButton, "saw-button"),
      A.bind(i.__sawButton, "click", function(e) {
        e.stopPropagation(),
          e.preventDefault(),
          "saw" === o.__animationMode
            ? (r(), A.removeClass(o.__sawButton, "saw-button--activated"))
            : ("sine" === o.__animationMode && A.removeClass(o.__sineButton, "sine-button--activated"),
              (o.__animationMode = "saw"),
              A.addClass(o.__sawButton, "saw-button--activated"),
              a());
      }),
      A.bind(i.__sineButton, "click", function(e) {
        e.stopPropagation(),
          e.preventDefault(),
          "sine" === o.__animationMode
            ? (r(), A.removeClass(o.__sineButton, "sine-button--activated"))
            : ("saw" === o.__animationMode && A.removeClass(o.__sawButton, "saw-button--activated"),
              (o.__animationMode = "sine"),
              A.addClass(o.__sineButton, "sine-button--activated"),
              a());
      }),
      i.updateDisplay(),
      i.domElement.appendChild(i.__sawButton),
      i.domElement.appendChild(i.__sineButton),
      i
    );
  }
  var ke,
    Ae = (w(Te, (ke = b)),
    (Te.prototype.updateDisplay = function() {
      var e = this.getValue(),
        t = [];
      for (var n in e) t.push({ percent: n, color: e[n] });
      t.sort(function(e, t) {
        return e.percent - t.percent;
      }),
        (this.__input.value = JSON.stringify(e));
      for (var i = "-webkit-linear-gradient(left", o = 0; o < t.length; o++)
        i += ", " + t[o].color + " " + 100 * t[o].percent + "%";
      (i += ")"),
        h.extend(this.__input.style, { background: i, color: "#fff", textShadow: this.__input_textShadow + " #000" });
    }),
    Te);
  function Te(e, t, n) {
    var i,
      o = C((i = ke.call(this, e, t) || this));
    function a() {
      var e = JSON.parse(this.value);
      o.setValue(e);
    }
    (i.domElement = document.createElement("div")),
      A.makeSelectable(i.domElement, !1),
      (i.__selector = document.createElement("div")),
      (i.__selector.className = "selector"),
      (i.__saturation_field = document.createElement("div")),
      (i.__saturation_field.className = "saturation-field"),
      (i.__input = document.createElement("input")),
      (i.__input.type = "text"),
      (i.__input_textShadow = "1px 1px 2px"),
      A.bind(i.__input, "keydown", function(e) {
        13 === e.keyCode && a.call(this);
      }),
      A.bind(i.__input, "blur", a),
      A.bind(i.__selector, "mousedown", function() {
        A.addClass(this, "drag").bind(window, "mouseup", function() {
          A.removeClass(o.__selector, "drag");
        });
      });
    document.createElement("div");
    h.extend(i.__selector.style, {
      width: "150px",
      padding: "0px",
      lineHeight: "18px",
      backgroundColor: "#222",
      boxShadow: "0px 1px 3px rgba(0,0,0,0.3)"
    });
    for (var r = 0; r < n.length; r++) {
      var s = document.createElement("canvas");
      (s.value = n[r]), (s.width = 150), (s.height = 18);
      var l = s.getContext("2d"),
        d = l.createLinearGradient(0, 0, 150, 0);
      for (var u in n[r]) d.addColorStop(u, n[r][u]);
      A.bind(s, "click", function() {
        o.setValue(this.value), o.updateDisplay(), c();
      }),
        (l.fillStyle = d),
        l.fillRect(0, 0, s.width, s.height),
        h.extend(s.style, { width: "150px" }),
        i.__saturation_field.appendChild(s);
    }
    function c() {
      o.__onFinishChange && o.__onFinishChange.call(o, o.getValue());
    }
    return (
      i.__selector.appendChild(i.__saturation_field),
      i.domElement.appendChild(i.__input),
      i.domElement.appendChild(i.__selector),
      i.updateDisplay(),
      i
    );
  }
  var Le,
    Oe =
      window.requestAnimationFrame ||
      window.webkitRequestAnimationFrame ||
      window.mozRequestAnimationFrame ||
      window.oRequestAnimationFrame ||
      window.msRequestAnimationFrame ||
      function(e, t) {
        setTimeout(e, 1e3 / 60);
      },
    Be = (((Le = Ve.prototype).show = function() {
      var e = this;
      (this.backgroundElement.style.display = "block"),
        (this.domElement.style.display = "block"),
        (this.domElement.style.opacity = 0),
        (this.domElement.style.webkitTransform = "scale(1.1)"),
        this.layout(),
        h.defer(function() {
          (e.backgroundElement.style.opacity = 1),
            (e.domElement.style.opacity = 1),
            (e.domElement.style.webkitTransform = "scale(1)");
        });
    }),
    (Le.hide = function() {
      function e() {
        (t.domElement.style.display = "none"),
          (t.backgroundElement.style.display = "none"),
          A.unbind(t.domElement, "webkitTransitionEnd", e),
          A.unbind(t.domElement, "transitionend", e),
          A.unbind(t.domElement, "oTransitionEnd", e);
      }
      var t = this;
      A.bind(this.domElement, "webkitTransitionEnd", e),
        A.bind(this.domElement, "transitionend", e),
        A.bind(this.domElement, "oTransitionEnd", e),
        (this.backgroundElement.style.opacity = 0),
        (this.domElement.style.opacity = 0),
        (this.domElement.style.webkitTransform = "scale(1.1)");
    }),
    (Le.layout = function() {
      (this.domElement.style.left = window.innerWidth / 2 - A.getWidth(this.domElement) / 2 + "px"),
        (this.domElement.style.top = window.innerHeight / 2 - A.getHeight(this.domElement) / 2 + "px");
    }),
    Ve);
  function Ve() {
    (this.backgroundElement = document.createElement("div")),
      h.extend(this.backgroundElement.style, {
        backgroundColor: "rgba(0,0,0,0.8)",
        top: 0,
        left: 0,
        display: "none",
        zIndex: "1000",
        opacity: 0,
        WebkitTransition: "opacity 0.2s linear",
        transition: "opacity 0.2s linear"
      }),
      A.makeFullscreen(this.backgroundElement),
      (this.backgroundElement.style.position = "fixed"),
      (this.domElement = document.createElement("div")),
      h.extend(this.domElement.style, {
        position: "fixed",
        display: "none",
        zIndex: "1001",
        opacity: 0,
        WebkitTransition: "-webkit-transform 0.2s ease-out, opacity 0.2s linear",
        transition: "transform 0.2s ease-out, opacity 0.2s linear"
      }),
      document.body.appendChild(this.backgroundElement),
      document.body.appendChild(this.domElement);
    var e = this;
    A.bind(this.backgroundElement, "click", function() {
      e.hide();
    });
  }
  var Ne,
    Re,
    Ie,
    De,
    He = "Default",
    Fe = (function() {
      try {
        return !!window.localStorage;
      } catch (e) {
        return !1;
      }
    })(),
    Me = !0,
    Pe = !1,
    Ue = [],
    Ge = function t(e) {
      var n = this,
        i = e || {};
      (this.domElement = document.createElement("div")),
        (this.__ul = document.createElement("ul")),
        this.domElement.appendChild(this.__ul),
        A.addClass(this.domElement, "dg"),
        (this.__folders = {}),
        (this.__controllers = []),
        (this.__rememberedObjects = []),
        (this.__rememberedObjectIndecesToControllers = []),
        (this.__listening = []),
        (i = h.defaults(i, { closeOnTop: !1, autoPlace: !0, width: t.DEFAULT_WIDTH, showCloseButton: !0 })),
        (i = h.defaults(i, { resizable: i.autoPlace, hideable: i.autoPlace })),
        h.isUndefined(i.load) ? (i.load = { preset: He }) : i.preset && (i.load.preset = i.preset),
        h.isUndefined(i.parent) && i.hideable && Ue.push(this),
        (i.resizable = h.isUndefined(i.parent) && i.resizable),
        i.autoPlace && h.isUndefined(i.scrollable) && (i.scrollable = !0);
      var o,
        a,
        r = Fe && "true" === window.localStorage.getItem(Ye(this, "isLocal"));
      if (
        ((this.saveToLocalStorageIfPossible = function() {
          Fe &&
            "true" === window.localStorage.getItem(Ye(n, "isLocal")) &&
            window.localStorage.setItem(Ye(n, "gui"), JSON.stringify(n.getSaveObject()));
        }),
        Object.defineProperties(this, {
          lightTheme: {
            set: function(e) {
              (i.lightTheme = e)
                ? A.addClass(n.domElement, t.CLASS_LIGHT_THEME)
                : A.removeClass(n.domElement, t.CLASS_LIGHT_THEME);
            },
            get: function() {
              return i.lightTheme;
            }
          },
          showCloseButton: {
            set: function(e) {
              (i.showCloseButton = e)
                ? A.removeClass(n.__closeButton, t.CLASS_DISPLAY_NONE)
                : A.addClass(n.__closeButton, t.CLASS_DISPLAY_NONE);
            },
            get: function() {
              return i.showCloseButton;
            }
          },
          parent: {
            get: function() {
              return i.parent;
            }
          },
          scrollable: {
            get: function() {
              return i.scrollable;
            }
          },
          autoPlace: {
            get: function() {
              return i.autoPlace;
            }
          },
          closeOnTop: {
            get: function() {
              return i.closeOnTop;
            }
          },
          preset: {
            get: function() {
              return n.parent ? n.getRoot().preset : i.load.preset;
            },
            set: function(e) {
              n.parent ? (n.getRoot().preset = e) : (i.load.preset = e),
                (function(e) {
                  for (var t = 0; t < e.__preset_select.length; t++)
                    e.__preset_select[t].value === e.preset && (e.__preset_select.selectedIndex = t);
                })(this),
                n.revert();
            }
          },
          width: {
            get: function() {
              return i.width;
            },
            set: function(e) {
              (i.width = e), $e(n, e);
            }
          },
          name: {
            get: function() {
              return i.name;
            },
            set: function(e) {
              (i.name = e), o && (o.innerHTML = i.name);
            }
          },
          title: {
            get: function() {
              return i.title;
            },
            set: function(e) {
              (i.title = e), o && (h.isString(i.title) ? o.setAttribute("title", i.title) : o.removeAttribute("title"));
            }
          },
          closed: {
            get: function() {
              return i.closed;
            },
            set: function(e) {
              (i.closed = e),
                i.closed ? A.addClass(n.__ul, t.CLASS_CLOSED) : A.removeClass(n.__ul, t.CLASS_CLOSED),
                this.onResize(),
                n.__closeButton && (n.__closeButton.innerHTML = e ? t.TEXT_OPEN : t.TEXT_CLOSED);
            }
          },
          load: {
            get: function() {
              return i.load;
            }
          },
          useLocalStorage: {
            get: function() {
              return r;
            },
            set: function(e) {
              Fe &&
                ((r = e)
                  ? A.bind(window, "unload", n.saveToLocalStorageIfPossible)
                  : A.unbind(window, "unload", n.saveToLocalStorageIfPossible),
                window.localStorage.setItem(Ye(n, "isLocal"), e));
            }
          }
        }),
        h.isUndefined(i.parent))
      ) {
        if (
          ((this.closed = i.closed || !1),
          A.addClass(this.domElement, t.CLASS_MAIN),
          A.makeSelectable(this.domElement, !1),
          i.lightTheme && A.addClass(this.domElement, t.CLASS_LIGHT_THEME),
          Fe && r)
        ) {
          n.useLocalStorage = !0;
          var s = window.localStorage.getItem(Ye(this, "gui"));
          s && (i.load = JSON.parse(s));
        }
        (this.__closeButton = document.createElement("div")),
          (this.__closeButton.innerHTML = t.TEXT_CLOSED),
          A.addClass(this.__closeButton, t.CLASS_CLOSE_BUTTON),
          i.closeOnTop
            ? (A.addClass(this.__closeButton, t.CLASS_CLOSE_TOP),
              this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]))
            : (A.addClass(this.__closeButton, t.CLASS_CLOSE_BOTTOM), this.domElement.appendChild(this.__closeButton)),
          i.showCloseButton || A.addClass(this.__closeButton, t.CLASS_DISPLAY_NONE),
          A.bind(this.__closeButton, "click", function() {
            n.closed = !n.closed;
          });
      } else {
        void 0 === i.closed && (i.closed = !0);
        var l = document.createTextNode(i.name);
        A.addClass(l, "controller-name"), (o = je(n, l)), h.isString(i.title) && o.setAttribute("title", i.title);
        A.addClass(this.__ul, t.CLASS_CLOSED),
          A.addClass(o, "title"),
          A.bind(o, "click", function(e) {
            return e.preventDefault(), (n.closed = !n.closed), !1;
          }),
          i.closed || (this.closed = !1);
      }
      i.autoPlace &&
        (h.isUndefined(i.parent) &&
          (Me &&
            ((De = document.createElement("div")),
            A.addClass(De, "dg"),
            A.addClass(De, t.CLASS_AUTO_PLACE_CONTAINER),
            document.body.appendChild(De),
            (Me = !1)),
          De.appendChild(this.domElement),
          A.addClass(this.domElement, t.CLASS_AUTO_PLACE)),
        this.parent || $e(n, i.width)),
        (this.__resizeHandler = function() {
          n.onResizeDebounced();
        }),
        A.bind(window, "resize", this.__resizeHandler),
        A.bind(this.__ul, "webkitTransitionEnd", this.__resizeHandler),
        A.bind(this.__ul, "transitionend", this.__resizeHandler),
        A.bind(this.__ul, "oTransitionEnd", this.__resizeHandler),
        this.onResize(),
        i.resizable &&
          (function(t) {
            var n;
            function i(e) {
              return e.preventDefault(), (t.width += n - e.clientX), t.onResize(), (n = e.clientX), !1;
            }
            function o() {
              A.removeClass(t.__closeButton, Ge.CLASS_DRAG),
                A.unbind(window, "mousemove", i),
                A.unbind(window, "mouseup", o);
            }
            function e(e) {
              return (
                e.preventDefault(),
                (n = e.clientX),
                A.addClass(t.__closeButton, Ge.CLASS_DRAG),
                A.bind(window, "mousemove", i),
                A.bind(window, "mouseup", o),
                !1
              );
            }
            (t.__resize_handle = document.createElement("div")),
              h.extend(t.__resize_handle.style, {
                width: "6px",
                marginLeft: "-3px",
                height: "200px",
                cursor: "ew-resize",
                position: "absolute"
              }),
              A.bind(t.__resize_handle, "mousedown", e),
              A.bind(t.__closeButton, "mousedown", e),
              t.domElement.insertBefore(t.__resize_handle, t.domElement.firstElementChild);
          })(this),
        i.parent ||
          (((a = n.getRoot()).width += 1),
          h.defer(function() {
            a.width -= 1;
          })),
        h.isObject(i.object) &&
          h.each(i.object, function(e, t) {
            n.add(i.object, t);
          });
    };
  function je(e, t, n) {
    var i = document.createElement("li");
    return t && i.appendChild(t), n ? e.__ul.insertBefore(i, n) : e.__ul.appendChild(i), e.onResize(), i;
  }
  function ze(e) {
    A.unbind(window, "resize", e.__resizeHandler),
      e.saveToLocalStorageIfPossible && A.unbind(window, "unload", e.saveToLocalStorageIfPossible);
  }
  function Xe(e, t) {
    var n = e.__preset_select[e.__preset_select.selectedIndex];
    n.innerHTML = t ? n.value + "*" : n.value;
  }
  function Ke(e, t) {
    var n = e.getRoot(),
      i = n.__rememberedObjects.indexOf(t.object);
    if (-1 !== i) {
      var o = n.__rememberedObjectIndecesToControllers[i];
      if (
        (void 0 === o && ((o = {}), (n.__rememberedObjectIndecesToControllers[i] = o)),
        (o[t.property] = t),
        n.load && n.load.remembered)
      ) {
        var a,
          r = n.load.remembered;
        if (r[e.preset]) a = r[e.preset];
        else {
          if (!r[He]) return;
          a = r[He];
        }
        if (a[i] && void 0 !== a[i][t.property]) {
          var s = a[i][t.property];
          (t.initialValue = s), t.setValue(s, !0);
        }
      }
    }
  }
  function We(e, t, n, i, o) {
    if (!(t instanceof ae || o.custom || void 0 !== t[n]))
      throw new Error('Object "' + t + '" has no property "' + n + '"');
    var a;
    t[n];
    if (o.color) a = new W(t, n);
    else if (o.gradient) a = new Ae(t, n, o.factoryArgs[0]);
    else if (o.image) a = new fe(t, n, o.factoryArgs[0]);
    else if (o.plotter) (a = new ne(t, n, o)), e.listen(a);
    else if (o.file) a = new Q(t, n);
    else if (t instanceof ae && void 0 === n) a = t;
    else if (t instanceof ae || !o.custom || void 0 !== t[n]) {
      var r = t instanceof ae ? [n].concat(o.factoryArgs) : [t, n].concat(o.factoryArgs);
      a = Ee.apply(e, r);
    } else a = new ae(t, n);
    o.before instanceof b && (o.before = o.before.__li), Ke(e, a), A.addClass(a.domElement, "c");
    var s =
      o.custom && a instanceof ae == !1
        ? t instanceof ae
          ? t.domElement
          : new ae(t).domElement
        : document.createElement("span");
    null !== i ? (s.innerHTML = i) : o.custom || (s.innerHTML = a.property), A.addClass(s, "property-name");
    var l = document.createElement("div");
    l.appendChild(s), l.appendChild(a.domElement);
    var d = je(e, l, o.before);
    return (
      A.addClass(d, Ge.CLASS_CONTROLLER_ROW),
      a instanceof W
        ? A.addClass(d, "color")
        : a instanceof ne
        ? A.addClass(d, "plotter")
        : a instanceof Q
        ? A.addClass(d, "file")
        : a instanceof fe
        ? A.addClass(d, "image")
        : A.addClass(d, typeof a.getValue()),
      (function(o, t, a) {
        if (
          ((a.__li = t),
          (a.__gui = o),
          h.extend(a, {
            options: function(e) {
              if (1 < arguments.length) {
                var t = a.__li.nextElementSibling;
                return (
                  a.remove(), We(o, a.object, a.property, a.label, { before: t, factoryArgs: [h.toArray(arguments)] })
                );
              }
              if (h.isArray(e) || h.isObject(e)) {
                var n = a.__li.nextElementSibling;
                return a.remove(), We(o, a.object, a.property, a.label, { before: n, factoryArgs: [e] });
              }
            },
            name: function(e) {
              return (a.__li.firstElementChild.firstElementChild.innerHTML = e), a;
            },
            title: function(e) {
              return h.isString(e) ? a.__li.setAttribute("title", e) : a.__li.removeAttribute("title"), a;
            },
            listen: function(e) {
              return (a.forceUpdateDisplay = !!e), a.__gui.listen(a), a;
            },
            remove: function() {
              return a.__gui.remove(a), a;
            }
          }),
          a instanceof F)
        ) {
          var i = new I(a.object, a.property, { min: a.__min, max: a.__max, step: a.__step });
          h.each(["updateDisplay", "onChange", "onFinishChange", "step", "min", "max"], function(e) {
            var t = a[e],
              n = i[e];
            a[e] = i[e] = function() {
              var e = Array.prototype.slice.call(arguments);
              return n.apply(i, e), t.apply(a, e);
            };
          }),
            A.addClass(t, "has-slider"),
            a.domElement.insertBefore(i.domElement, a.domElement.firstElementChild);
          var r = new xe(a.object, a.property, { min: a.__min, max: a.__max, step: a.__step });
          h.each(["updateDisplay", "onChange", "onFinishChange", "step"], function(e) {
            var t = a[e],
              n = r[e];
            a[e] = r[e] = function() {
              var e = Array.prototype.slice.call(arguments);
              return n.apply(r, e), t.apply(a, e);
            };
          }),
            A.addClass(t, "has-animate-buttons"),
            a.domElement.insertBefore(r.domElement, a.domElement.firstElementChild);
        } else if (a instanceof I) {
          var e = function(e) {
            if (h.isNumber(a.__min) && h.isNumber(a.__max)) {
              var t = a.__li.firstElementChild.firstElementChild.innerHTML,
                n = -1 < a.__gui.__listening.indexOf(a);
              a.remove();
              var i = We(o, a.object, a.property, a.label, {
                before: a.__li.nextElementSibling,
                factoryArgs: [a.__min, a.__max, a.__step]
              });
              return i.name(t), n && i.listen(), i;
            }
            return e;
          };
          (a.min = h.compose(
            e,
            a.min
          )),
            (a.max = h.compose(
              e,
              a.max
            ));
        } else
          a instanceof T
            ? (A.bind(t, "click", function() {
                A.fakeEvent(a.__checkbox, "click");
              }),
              A.bind(a.__checkbox, "click", function(e) {
                e.stopPropagation();
              }))
            : a instanceof U || a instanceof z
            ? (A.bind(t, "click", function() {
                A.fakeEvent(a.__button, "click");
              }),
              A.bind(t, "mouseover", function() {
                A.addClass(a.__button, "hover");
              }),
              A.bind(t, "mouseout", function() {
                A.removeClass(a.__button, "hover");
              }))
            : a instanceof W
            ? (A.addClass(t, "color"),
              (a.updateDisplay = h.compose(
                function(e) {
                  return (t.style.borderLeftColor = a.__color.toHexString()), e;
                },
                a.updateDisplay
              )),
              a.updateDisplay())
            : a instanceof me
            ? (A.addClass(t, "array"),
              (a.updateDisplay = h.compose(
                function() {
                  t.style.height = 26 * (a.__inputs.length + 1) + "px";
                },
                a.updateDisplay
              )),
              a.updateDisplay())
            : a instanceof Ae
            ? (t.style.borderLeft = "3px solid #2FA1D6")
            : a instanceof ye
            ? A.addClass(t, "vector")
            : a instanceof Q && A.addClass(t, "file");
        a.setValue = h.compose(
          function(e) {
            return o.getRoot().__preset_select && a.isModified() && Xe(o.getRoot(), !0), e;
          },
          a.setValue
        );
      })(e, d, a),
      e.__controllers.push(a),
      a
    );
  }
  function Ye(e, t) {
    return "dat.gui." + (window.localStorage.getItem("dat.gui.namespace") || document.location.href) + "." + t;
  }
  function Je(e, t, n) {
    var i = document.createElement("option");
    (i.innerHTML = t),
      (i.value = t),
      e.__preset_select.appendChild(i),
      n && (e.__preset_select.selectedIndex = e.__preset_select.length - 1);
  }
  function qe(e, t) {
    t.style.display = e.useLocalStorage ? "block" : "none";
  }
  function $e(e, t) {
    (e.domElement.style.width = t + "px"),
      e.__save_row && e.autoPlace && (e.__save_row.style.width = t + "px"),
      e.__closeButton && (e.__closeButton.style.width = t + "px");
  }
  function Qe(o, a) {
    var r = {};
    return (
      h.each(o.__rememberedObjects, function(e, t) {
        var n = {},
          i = o.__rememberedObjectIndecesToControllers[t];
        h.each(i, function(e, t) {
          n[t] = a ? e.initialValue : e.getValue();
        }),
          (r[t] = n);
      }),
      r
    );
  }
  (Ge.CustomController = ae),
    (Ge.toggleHide = function() {
      (Pe = !Pe),
        h.each(Ue, function(e) {
          e.domElement.style.display = Pe ? "none" : "";
        });
    }),
    (Ge.CLASS_AUTO_PLACE = "a"),
    (Ge.CLASS_AUTO_PLACE_CONTAINER = "ac"),
    (Ge.CLASS_MAIN = "main"),
    (Ge.CLASS_CONTROLLER_ROW = "cr"),
    (Ge.CLASS_TOO_TALL = "taller-than-window"),
    (Ge.CLASS_CLOSED = "closed"),
    (Ge.CLASS_CLOSE_BUTTON = "close-button"),
    (Ge.CLASS_CLOSE_TOP = "close-top"),
    (Ge.CLASS_CLOSE_BOTTOM = "close-bottom"),
    (Ge.CLASS_DRAG = "drag"),
    (Ge.CLASS_DISPLAY_NONE = "display-none"),
    (Ge.CLASS_LIGHT_THEME = "light-theme"),
    (Ge.DEFAULT_WIDTH = 245),
    (Ge.TEXT_CLOSED = "Close View Controls"),
    (Ge.TEXT_OPEN = "Open View Controls"),
    (Ge._keydownHandler = function(e) {
      !document.activeElement ||
        "text" === document.activeElement.type ||
        (72 !== e.which && 72 !== e.keyCode) ||
        Ge.toggleHide();
    }),
    A.bind(window, "keydown", Ge._keydownHandler, !1),
    h.extend(Ge.prototype, {
      add: function(e, t, n) {
        return We(this, e, t, n, { custom: e instanceof ae, factoryArgs: Array.prototype.slice.call(arguments, 3) });
      },
      openExportWindow: function(e, t) {
        if (h.isUndefined(Ne)) {
          ((Ne = new Be()).domElement.innerHTML = ve), (Ie = document.getElementById("dg-title"));
          var n = ace.require("ace/mode/json").Mode;
          (Re = ace.edit("dg-new-editor")).setTheme("ace/theme/solarized_dark"),
            Re.session.setMode(new n()),
            Re.setReadOnly(!0);
        }
        this.autoPlace && $e(this, this.width),
          (Ie.innerHTML = e),
          Re.setValue(JSON.stringify(t, void 0, 2)),
          Ne.show(),
          Re.focus();
      },
      plugins: {
        autocomplete: function(s) {
          var l,
            r,
            d = document,
            u = d.createElement("div"),
            c = u.style,
            e = navigator.userAgent,
            t = -1 !== e.indexOf("Firefox") && -1 !== e.indexOf("Mobile"),
            _ = s.debounceWaitMs || 0,
            n = t ? "input" : "keyup",
            h = [],
            p = "",
            f = s.minLength,
            m = 0;
          if (!s.input) throw new Error("input undefined");
          var g = s.input;
          function v() {
            r && window.clearTimeout(r);
          }
          function b() {
            return !!u.parentNode;
          }
          function y() {
            m++,
              (h = []),
              (p = ""),
              (l = void 0),
              (function() {
                var e = u.parentNode;
                e && e.removeChild(u);
              })();
          }
          function w() {
            for (; u.firstChild; ) u.removeChild(u.firstChild);
            var i = function(e, t) {
              var n = d.createElement("div");
              return (n.textContent = e.label || ""), n;
            };
            s.render && (i = s.render);
            var o = function(e, t) {
              var n = d.createElement("div");
              return (n.textContent = e), n;
            };
            s.renderGroup && (o = s.renderGroup);
            var a = d.createDocumentFragment(),
              r = "#9?$";
            if (
              (h.forEach(function(t) {
                if (t.group && t.group !== r) {
                  r = t.group;
                  var e = o(t.group, p);
                  e && ((e.className += " group"), a.appendChild(e));
                }
                var n = i(t, p);
                n &&
                  (n.addEventListener("click", function(e) {
                    s.onSelect(t, g), y(), e.preventDefault(), e.stopPropagation();
                  }),
                  t === l && ((n.className += " selected"), "function" == typeof s.onPick && s.onPick(t)),
                  a.appendChild(n));
              }),
              u.appendChild(a),
              h.length < 1)
            ) {
              if (!s.emptyMsg) return void y();
              var e = d.createElement("div");
              (e.className = "empty"), (e.textContent = s.emptyMsg), u.appendChild(e);
            }
            u.parentNode || d.body.appendChild(u),
              (function() {
                if (b()) {
                  (c.height = "auto"), (c.width = g.offsetWidth + "px");
                  var e = g.getBoundingClientRect(),
                    t = e.top + g.offsetHeight,
                    n = window.innerHeight - t;
                  n < 0 && (n = 0),
                    (c.top = t + "px"),
                    (c.bottom = ""),
                    (c.left = e.left + "px"),
                    (c.maxHeight = n + "px"),
                    s.customize && s.customize(g, e, u, n);
                }
              })(),
              (function() {
                var e = u.getElementsByClassName("selected");
                if (0 < e.length) {
                  var t = e[0],
                    n = t.previousElementSibling;
                  if (
                    (n && -1 !== n.className.indexOf("group") && !n.previousElementSibling && (t = n),
                    t.offsetTop < u.scrollTop)
                  )
                    u.scrollTop = t.offsetTop;
                  else {
                    var i = t.offsetTop + t.offsetHeight,
                      o = u.scrollTop + u.offsetHeight;
                    o < i && (u.scrollTop += i - o);
                  }
                }
              })();
          }
          function i() {
            b() && w();
          }
          function o() {
            i();
          }
          function a(e) {
            e.target !== u ? i() : e.preventDefault();
          }
          function C(e) {
            for (
              var t = e.which || e.keyCode || 0, n = 0, i = [38, 13, 27, 39, 37, 16, 17, 18, 20, 91, 9];
              n < i.length;
              n++
            ) {
              if (t === i[n]) return;
            }
            if (40 !== t || !b()) {
              var o = ++m,
                a = g.value;
              a.length >= f
                ? (v(),
                  (r = window.setTimeout(function() {
                    s.fetch(a, function(e) {
                      m === o && e && ((p = a), (l = 0 < (h = e).length ? h[0] : void 0), w());
                    });
                  }, _)))
                : y();
            }
          }
          function E(e) {
            var t = g.value;
            0 === t.length &&
              s.fetch(t, function(e) {
                (p = t), (l = 0 < (h = e).length ? h[0] : void 0), w();
              });
          }
          function x(e) {
            var t = e.which || e.keyCode || 0;
            if (38 === t || 40 === t || 27 === t) {
              var n = b();
              if (27 === t) y();
              else {
                if (h.length < 1) return;
                38 === t
                  ? (function() {
                      if (h.length < 1) l = void 0;
                      else if (l === h[0]) l = h[h.length - 1];
                      else
                        for (var e = h.length - 1; 0 < e; e--)
                          if (l === h[e] || 1 === e) {
                            l = h[e - 1];
                            break;
                          }
                    })()
                  : (function() {
                      if ((h.length < 1 && (l = void 0), l && l !== h[h.length - 1])) {
                        for (var e = 0; e < h.length - 1; e++)
                          if (l === h[e]) {
                            l = h[e + 1];
                            break;
                          }
                      } else l = h[0];
                    })(),
                  w();
              }
              return e.preventDefault(), void (n && e.stopPropagation());
            }
            13 === t && l && (s.onSelect(l, g), y());
          }
          function S() {
            setTimeout(function() {
              d.activeElement !== g && y();
            }, 200);
          }
          return (
            (u.className = "autocomplete " + (s.className || "")),
            (c.position = "fixed"),
            g.addEventListener("focus", E),
            g.addEventListener("keydown", x),
            g.addEventListener(n, C),
            g.addEventListener("blur", S),
            window.addEventListener("resize", o),
            d.addEventListener("scroll", a, !0),
            {
              destroy: function() {
                g.removeEventListener("keydown", x),
                  g.removeEventListener("focus", E),
                  g.removeEventListener(n, C),
                  g.removeEventListener("blur", S),
                  window.removeEventListener("resize", o),
                  d.removeEventListener("scroll", a, !0),
                  v(),
                  y(),
                  m++;
              }
            }
          );
        }
      },
      addColor: function(e, t, n) {
        return We(this, e, t, n, { color: !0 });
      },
      addPlotter: function(e, t, n, i, o, a, r) {
        return We(this, e, t, {
          plotter: !0,
          max: n || 10,
          period: "number" == typeof i ? i : 500,
          type: o || "line",
          fgColor: a || "#fff",
          bgColor: r || "#000"
        });
      },
      addFile: function(e, t) {
        return We(this, e, t, { file: !0 });
      },
      addCustomController: function(e, t) {
        return We(this, e, t, { custom: !0, factoryArgs: Array.prototype.slice.call(arguments, 2) });
      },
      addGradient: function(e, t, n) {
        return We(this, e, t, n, { gradient: !0, factoryArgs: Array.prototype.slice.call(arguments, 3) });
      },
      addImage: function(e, t, n) {
        return We(this, e, t, n, { factoryArgs: Array.prototype.slice.call(arguments, 3), image: !0 });
      },
      remove: function(e) {
        var t = this.__listening.indexOf(e);
        -1 !== t && this.__listening.splice(t, 1),
          e.destruct && e.destruct(),
          this.__ul.removeChild(e.__li),
          this.__controllers.splice(this.__controllers.indexOf(e), 1);
        var n = this;
        h.defer(function() {
          n.onResize();
        });
      },
      destroy: function() {
        if (this.parent)
          throw new Error(
            "Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead."
          );
        this.autoPlace && De.removeChild(this.domElement);
        var n = this;
        h.each(this.__folders, function(e, t) {
          n.removeFolder(t);
        }),
          A.unbind(window, "keydown", Ge._keydownHandler, !1),
          ze(this);
        for (var e = this.__listening.length - 1; 0 <= e; e--) this.__listening.splice(e, 1);
      },
      addFolder: function(e, t) {
        if (void 0 !== this.__folders[e])
          throw new Error('You already have a folder in this GUI by the name "' + e + '"');
        var n = { name: e, parent: this, title: t };
        (n.autoPlace = this.autoPlace),
          this.load &&
            this.load.folders &&
            this.load.folders[e] &&
            ((n.closed = this.load.folders[e].closed), (n.load = this.load.folders[e]));
        var i = new Ge(n);
        this.__folders[e] = i;
        var o = je(this, i.domElement);
        return A.addClass(o, "folder"), i;
      },
      removeFolder: function(e) {
        var t = this.__folders[e];
        if (t) {
          t.close(),
            this.__ul.removeChild(t.domElement.parentElement),
            delete this.__folders[t.name],
            this.load && this.load.folders && this.load.folders[t.name] && delete this.load.folders[t.name],
            ze(t);
          var n = this;
          h.each(t.__folders, function(e) {
            t.removeFolder(e);
          }),
            h.defer(function() {
              n.onResize();
            });
        } else console.error('There is no folder in this GUI by the name "' + e + '"');
      },
      open: function() {
        this.closed = !1;
      },
      close: function() {
        this.closed = !0;
      },
      hide: function() {
        this.domElement.style.display = "none";
      },
      show: function() {
        this.domElement.style.display = "";
      },
      onFinishRevert: function(e) {
        return (this.__onFinishRevert = e), this;
      },
      onResize: function() {
        var t = this.getRoot();
        if (t.scrollable) {
          A.getOffset(t.__ul).top;
          var n = 0;
          h.each(t.__ul.childNodes, function(e) {
            (t.autoPlace && e === t.__save_row) || (n += A.getHeight(e));
          }),
            t.domElement.clientHeight - 20 < n
              ? (A.addClass(t.domElement, Ge.CLASS_TOO_TALL),
                (t.__ul.style.height = t.domElement.clientHeight - 20 + "px"))
              : (A.removeClass(t.domElement, Ge.CLASS_TOO_TALL), (t.__ul.style.height = "auto"));
        }
        t.__resize_handle &&
          h.defer(function() {
            t.__resize_handle.style.height = t.__ul.offsetHeight + "px";
          }),
          t.__closeButton && (t.__closeButton.style.width = t.width + "px");
      },
      onResizeDebounced: h.debounce(function() {
        this.onResize();
      }, 50),
      remember: function() {
        if ((h.isUndefined(Ne) && ((Ne = new Be()).domElement.innerHTML = ve), this.parent))
          throw new Error("You can only call remember on a top level GUI.");
        var t = this;
        h.each(Array.prototype.slice.call(arguments), function(e) {
          0 === t.__rememberedObjects.length &&
            (function(n) {
              var e = (n.__save_row = document.createElement("li"));
              A.addClass(n.domElement, "has-save"),
                n.__ul.insertBefore(e, n.__ul.firstChild),
                A.addClass(e, "save-row");
              var t = document.createElement("span");
              (t.innerHTML = "&nbsp;"), A.addClass(t, "button gears");
              var i = document.createElement("span");
              (i.innerHTML = "Save"), A.addClass(i, "button"), A.addClass(i, "save");
              var o = document.createElement("span");
              (o.innerHTML = "New"), A.addClass(o, "button"), A.addClass(o, "save-as");
              var a = document.createElement("span");
              (a.innerHTML = "Revert"), A.addClass(a, "button"), A.addClass(a, "revert");
              var r = document.createElement("span");
              (r.innerHTML = "Delete"), A.addClass(r, "button"), A.addClass(r, "delete");
              var s = (n.__preset_select = document.createElement("select"));
              n.load && n.load.remembered
                ? h.each(n.load.remembered, function(e, t) {
                    Je(n, t, t === n.preset);
                  })
                : Je(n, He, !1);
              if (
                (A.bind(s, "change", function() {
                  for (var e = 0; e < n.__preset_select.length; e++)
                    n.__preset_select[e].innerHTML = n.__preset_select[e].value;
                  n.preset = this.value;
                }),
                e.appendChild(s),
                e.appendChild(t),
                e.appendChild(i),
                e.appendChild(o),
                e.appendChild(a),
                e.appendChild(r),
                Fe)
              ) {
                var l = document.getElementById("dg-local-explain"),
                  d = document.getElementById("dg-local-storage");
                (document.getElementById("dg-save-locally").style.display = "block"),
                  "true" === window.localStorage.getItem(Ye(n, "isLocal")) && d.setAttribute("checked", "checked"),
                  qe(n, l),
                  A.bind(d, "change", function() {
                    (n.useLocalStorage = !n.useLocalStorage), qe(n, l);
                  });
              }
              var u = document.getElementById("dg-new-constructor");
              A.bind(u, "keydown", function(e) {
                !e.metaKey || (67 !== e.which && 67 !== e.keyCode) || Ne.hide();
              }),
                A.bind(t, "click", function() {
                  (u.innerHTML = JSON.stringify(n.getSaveObject(), void 0, 2)), Ne.show(), u.focus(), u.select();
                }),
                A.bind(i, "click", function() {
                  n.save();
                }),
                A.bind(o, "click", function() {
                  var e = prompt("Enter a new preset name.");
                  e && n.saveAs(e);
                }),
                A.bind(a, "click", function() {
                  n.revert();
                }),
                A.bind(r, "click", function() {
                  n.preset !== He
                    ? confirm('Are you sure you want to delete preset "' + n.preset + '"?') && n.deleteSave()
                    : alert("Default preset can't be deleted.");
                });
            })(t),
            -1 === t.__rememberedObjects.indexOf(e) && t.__rememberedObjects.push(e);
        }),
          this.autoPlace && ((this.width += 40), $e(this, this.width));
      },
      getRoot: function() {
        for (var e = this; e.parent; ) e = e.parent;
        return e;
      },
      getSaveObject: function() {
        var n = this.load;
        return (
          (n.closed = this.closed),
          0 < this.__rememberedObjects.length &&
            ((n.preset = this.preset), n.remembered || (n.remembered = {}), (n.remembered[this.preset] = Qe(this))),
          (n.folders = {}),
          h.each(this.__folders, function(e, t) {
            n.folders[t] = e.getSaveObject();
          }),
          n
        );
      },
      save: function() {
        this.load.remembered || (this.load.remembered = {}),
          (this.load.remembered[this.preset] = Qe(this)),
          Xe(this, !1),
          this.saveToLocalStorageIfPossible();
      },
      saveAs: function(e) {
        this.load.remembered || ((this.load.remembered = {}), (this.load.remembered[He] = Qe(this, !0))),
          (this.load.remembered[e] = Qe(this)),
          (this.preset = e),
          Je(this, e, !0),
          this.saveToLocalStorageIfPossible();
      },
      revert: function(t) {
        var n = this.getRoot();
        h.each(
          this.__controllers,
          function(e) {
            this.getRoot().load.remembered ? Ke(t || this.getRoot(), e) : e.setValue(e.initialValue, !0),
              !n.__onFinishRevert && e.__onFinishChange && e.__onFinishChange.call(e, e.getValue());
          },
          this
        ),
          h.each(this.__folders, function(e) {
            e.revert(e);
          }),
          t || Xe(this.getRoot(), !1),
          n === this && n.__onFinishRevert && n.__onFinishRevert.call(n);
      },
      deleteSave: function() {
        if (this.preset !== He) {
          var e = this.__preset_select[this.__preset_select.selectedIndex];
          this.__preset_select.removeChild(e),
            (this.__preset_select.selectedIndex = 0),
            delete this.load.remembered[this.preset],
            (this.preset = He),
            this.saveToLocalStorageIfPossible();
        }
      },
      listen: function(e) {
        var t = 0 === this.__listening.length;
        this.__listening.push(e),
          t &&
            (function e(t) {
              0 !== t.length &&
                Oe.call(window, function() {
                  e(t);
                });
              h.each(t, function(e) {
                e.updateDisplay();
              });
            })(this.__listening);
      },
      updateDisplay: function() {
        h.each(this.__controllers, function(e) {
          e.updateDisplay();
        }),
          h.each(this.__folders, function(e) {
            e.updateDisplay();
          });
      }
    });
  var Ze = { Color: f, math: c, interpret: p },
    et = {
      Controller: b,
      BooleanController: T,
      OptionController: L,
      StringController: O,
      NumberController: N,
      NumberControllerBox: I,
      NumberControllerSlider: F,
      FunctionController: U,
      TabbedController: z,
      ColorController: W,
      FileController: Q,
      PlotterController: ne,
      CustomController: ae,
      ImageController: fe,
      ArrayController: me
    },
    tt = { dom: A },
    nt = { GUI: Ge },
    it = Ge,
    ot = { color: Ze, controllers: et, dom: tt, gui: nt, GUI: it };
  (t.GUI = it),
    (t.color = Ze),
    (t.controllers = et),
    (t.default = ot),
    (t.dom = tt),
    (t.gui = nt),
    Object.defineProperty(t, "__esModule", { value: !0 });
});
